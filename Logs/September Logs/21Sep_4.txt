/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/cuda/__init__.py:619: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:01<?, ?it/s, accuracy=0.938]  2%|▏         | 1/63 [00:01<01:27,  1.41s/it, accuracy=0.938]  2%|▏         | 1/63 [00:01<01:27,  1.41s/it, accuracy=0.906]  2%|▏         | 1/63 [00:01<01:27,  1.41s/it, accuracy=0.938]  5%|▍         | 3/63 [00:01<00:24,  2.45it/s, accuracy=0.938]  5%|▍         | 3/63 [00:01<00:24,  2.45it/s, accuracy=0.922]  5%|▍         | 3/63 [00:01<00:24,  2.45it/s, accuracy=0.931]  8%|▊         | 5/63 [00:01<00:13,  4.27it/s, accuracy=0.931]  8%|▊         | 5/63 [00:01<00:13,  4.27it/s, accuracy=0.938]  8%|▊         | 5/63 [00:01<00:13,  4.27it/s, accuracy=0.942]  8%|▊         | 5/63 [00:01<00:13,  4.27it/s, accuracy=0.941] 13%|█▎        | 8/63 [00:01<00:07,  7.32it/s, accuracy=0.941] 13%|█▎        | 8/63 [00:01<00:07,  7.32it/s, accuracy=0.944] 13%|█▎        | 8/63 [00:01<00:07,  7.32it/s, accuracy=0.944] 13%|█▎        | 8/63 [00:01<00:07,  7.32it/s, accuracy=0.946] 17%|█▋        | 11/63 [00:01<00:05, 10.18it/s, accuracy=0.946] 17%|█▋        | 11/63 [00:01<00:05, 10.18it/s, accuracy=0.948] 17%|█▋        | 11/63 [00:02<00:05, 10.18it/s, accuracy=0.95]  17%|█▋        | 11/63 [00:02<00:05, 10.18it/s, accuracy=0.946] 22%|██▏       | 14/63 [00:02<00:03, 12.73it/s, accuracy=0.946] 22%|██▏       | 14/63 [00:02<00:03, 12.73it/s, accuracy=0.946] 22%|██▏       | 14/63 [00:02<00:03, 12.73it/s, accuracy=0.941] 22%|██▏       | 14/63 [00:02<00:03, 12.73it/s, accuracy=0.936] 27%|██▋       | 17/63 [00:02<00:03, 14.94it/s, accuracy=0.936] 27%|██▋       | 17/63 [00:02<00:03, 14.94it/s, accuracy=0.936] 27%|██▋       | 17/63 [00:02<00:03, 14.94it/s, accuracy=0.931] 27%|██▋       | 17/63 [00:02<00:03, 14.94it/s, accuracy=0.927] 32%|███▏      | 20/63 [00:02<00:02, 16.57it/s, accuracy=0.927] 32%|███▏      | 20/63 [00:02<00:02, 16.57it/s, accuracy=0.924] 32%|███▏      | 20/63 [00:02<00:02, 16.57it/s, accuracy=0.919] 32%|███▏      | 20/63 [00:02<00:02, 16.57it/s, accuracy=0.912] 37%|███▋      | 23/63 [00:02<00:02, 17.85it/s, accuracy=0.912] 37%|███▋      | 23/63 [00:02<00:02, 17.85it/s, accuracy=0.906] 37%|███▋      | 23/63 [00:02<00:02, 17.85it/s, accuracy=0.905] 37%|███▋      | 23/63 [00:02<00:02, 17.85it/s, accuracy=0.901] 41%|████▏     | 26/63 [00:02<00:02, 17.84it/s, accuracy=0.901] 41%|████▏     | 26/63 [00:02<00:02, 17.84it/s, accuracy=0.9]   41%|████▏     | 26/63 [00:02<00:02, 17.84it/s, accuracy=0.902] 41%|████▏     | 26/63 [00:02<00:02, 17.84it/s, accuracy=0.9]   46%|████▌     | 29/63 [00:02<00:01, 18.68it/s, accuracy=0.9] 46%|████▌     | 29/63 [00:02<00:01, 18.68it/s, accuracy=0.898] 46%|████▌     | 29/63 [00:02<00:01, 18.68it/s, accuracy=0.896] 46%|████▌     | 29/63 [00:02<00:01, 18.68it/s, accuracy=0.896] 51%|█████     | 32/63 [00:02<00:01, 19.34it/s, accuracy=0.896] 51%|█████     | 32/63 [00:03<00:01, 19.34it/s, accuracy=0.895] 51%|█████     | 32/63 [00:03<00:01, 19.34it/s, accuracy=0.892] 51%|█████     | 32/63 [00:03<00:01, 19.34it/s, accuracy=0.887] 56%|█████▌    | 35/63 [00:03<00:01, 19.93it/s, accuracy=0.887] 56%|█████▌    | 35/63 [00:03<00:01, 19.93it/s, accuracy=0.885] 56%|█████▌    | 35/63 [00:03<00:01, 19.93it/s, accuracy=0.883] 56%|█████▌    | 35/63 [00:03<00:01, 19.93it/s, accuracy=0.882] 60%|██████    | 38/63 [00:03<00:01, 20.03it/s, accuracy=0.882] 60%|██████    | 38/63 [00:03<00:01, 20.03it/s, accuracy=0.883] 60%|██████    | 38/63 [00:03<00:01, 20.03it/s, accuracy=0.884] 60%|██████    | 38/63 [00:03<00:01, 20.03it/s, accuracy=0.886] 65%|██████▌   | 41/63 [00:03<00:01, 20.19it/s, accuracy=0.886] 65%|██████▌   | 41/63 [00:03<00:01, 20.19it/s, accuracy=0.887] 65%|██████▌   | 41/63 [00:03<00:01, 20.19it/s, accuracy=0.89]  65%|██████▌   | 41/63 [00:03<00:01, 20.19it/s, accuracy=0.887] 70%|██████▉   | 44/63 [00:03<00:00, 19.09it/s, accuracy=0.887] 70%|██████▉   | 44/63 [00:03<00:00, 19.09it/s, accuracy=0.887] 70%|██████▉   | 44/63 [00:03<00:00, 19.09it/s, accuracy=0.887] 73%|███████▎  | 46/63 [00:03<00:01, 16.03it/s, accuracy=0.887] 73%|███████▎  | 46/63 [00:03<00:01, 16.03it/s, accuracy=0.886] 73%|███████▎  | 46/63 [00:03<00:01, 16.03it/s, accuracy=0.887] 76%|███████▌  | 48/63 [00:03<00:00, 16.78it/s, accuracy=0.887] 76%|███████▌  | 48/63 [00:03<00:00, 16.78it/s, accuracy=0.887] 76%|███████▌  | 48/63 [00:03<00:00, 16.78it/s, accuracy=0.887] 76%|███████▌  | 48/63 [00:04<00:00, 16.78it/s, accuracy=0.888] 81%|████████  | 51/63 [00:04<00:00, 17.88it/s, accuracy=0.888] 81%|████████  | 51/63 [00:04<00:00, 17.88it/s, accuracy=0.888] 81%|████████  | 51/63 [00:04<00:00, 17.88it/s, accuracy=0.889] 81%|████████  | 51/63 [00:04<00:00, 17.88it/s, accuracy=0.889] 86%|████████▌ | 54/63 [00:04<00:00, 18.65it/s, accuracy=0.889] 86%|████████▌ | 54/63 [00:04<00:00, 18.65it/s, accuracy=0.891] 86%|████████▌ | 54/63 [00:04<00:00, 18.65it/s, accuracy=0.892] 86%|████████▌ | 54/63 [00:04<00:00, 18.65it/s, accuracy=0.893] 90%|█████████ | 57/63 [00:04<00:00, 19.40it/s, accuracy=0.893] 90%|█████████ | 57/63 [00:04<00:00, 19.40it/s, accuracy=0.892] 90%|█████████ | 57/63 [00:04<00:00, 19.40it/s, accuracy=0.891] 90%|█████████ | 57/63 [00:04<00:00, 19.40it/s, accuracy=0.893] 95%|█████████▌| 60/63 [00:04<00:00, 19.67it/s, accuracy=0.893] 95%|█████████▌| 60/63 [00:04<00:00, 19.67it/s, accuracy=0.895] 95%|█████████▌| 60/63 [00:04<00:00, 19.67it/s, accuracy=0.896] 98%|█████████▊| 62/63 [00:04<00:00, 19.69it/s, accuracy=0.896] 98%|█████████▊| 62/63 [00:04<00:00, 19.69it/s, accuracy=0.895]100%|██████████| 63/63 [00:04<00:00, 13.71it/s, accuracy=0.895]
Final Accuracy : 0.8955
Average Loss: 0.013416860935278236
Traceback (most recent call last):
  File "/home/project/Documents/RoTTA Enhancement/Modules/resnet.py", line 25, in <module>
    evaluate_tta(loader, model, model_name, attack_type)
  File "/home/project/Documents/RoTTA Enhancement/Modules/helper.py", line 93, in evaluate_tta
    save_confmat_and_metrics(all_labels, all_preds, model_name, attack_type, avg_loss, output_folder)
  File "/home/project/Documents/RoTTA Enhancement/Modules/helper.py", line 29, in save_confmat_and_metrics
    tn, fp, fn, tp = confmat.ravel()
    ^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
