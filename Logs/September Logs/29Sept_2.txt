/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/cuda/__init__.py:619: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:08,  7.44it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:08,  7.44it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:08,  7.44it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.52it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.52it/s, accuracy=0] 10%|▉         | 6/63 [00:01<00:07,  7.52it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.74it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.74it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.74it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.81it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.81it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.81it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.80it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.80it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.80it/s, accuracy=0] 22%|██▏       | 14/63 [00:01<00:06,  7.67it/s, accuracy=0] 22%|██▏       | 14/63 [00:01<00:06,  7.67it/s, accuracy=0] 22%|██▏       | 14/63 [00:02<00:06,  7.67it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.49it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.49it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.49it/s, accuracy=0] 29%|██▊       | 18/63 [00:02<00:06,  7.16it/s, accuracy=0] 29%|██▊       | 18/63 [00:02<00:06,  7.16it/s, accuracy=0.00822] 29%|██▊       | 18/63 [00:02<00:06,  7.16it/s, accuracy=0.0297]  32%|███▏      | 20/63 [00:02<00:06,  7.04it/s, accuracy=0.0297] 32%|███▏      | 20/63 [00:02<00:06,  7.04it/s, accuracy=0.061]  32%|███▏      | 20/63 [00:03<00:06,  7.04it/s, accuracy=0.0938] 35%|███▍      | 22/63 [00:03<00:06,  6.67it/s, accuracy=0.0938] 35%|███▍      | 22/63 [00:03<00:06,  6.67it/s, accuracy=0.125]  35%|███▍      | 22/63 [00:03<00:06,  6.67it/s, accuracy=0.158] 38%|███▊      | 24/63 [00:03<00:06,  6.38it/s, accuracy=0.158] 38%|███▊      | 24/63 [00:03<00:06,  6.38it/s, accuracy=0.185] 38%|███▊      | 24/63 [00:03<00:06,  6.38it/s, accuracy=0.178] 41%|████▏     | 26/63 [00:03<00:05,  6.29it/s, accuracy=0.178] 41%|████▏     | 26/63 [00:03<00:05,  6.29it/s, accuracy=0.171] 41%|████▏     | 26/63 [00:04<00:05,  6.29it/s, accuracy=0.165] 44%|████▍     | 28/63 [00:04<00:06,  5.72it/s, accuracy=0.165] 44%|████▍     | 28/63 [00:04<00:06,  5.72it/s, accuracy=0.159] 44%|████▍     | 28/63 [00:04<00:06,  5.72it/s, accuracy=0.154] 48%|████▊     | 30/63 [00:04<00:05,  5.72it/s, accuracy=0.154] 48%|████▊     | 30/63 [00:04<00:05,  5.72it/s, accuracy=0.149] 48%|████▊     | 30/63 [00:04<00:05,  5.72it/s, accuracy=0.145] 51%|█████     | 32/63 [00:04<00:05,  5.28it/s, accuracy=0.145] 51%|█████     | 32/63 [00:05<00:05,  5.28it/s, accuracy=0.14]  51%|█████     | 32/63 [00:05<00:05,  5.28it/s, accuracy=0.136] 54%|█████▍    | 34/63 [00:05<00:05,  5.36it/s, accuracy=0.136] 54%|█████▍    | 34/63 [00:05<00:05,  5.36it/s, accuracy=0.133] 54%|█████▍    | 34/63 [00:05<00:05,  5.36it/s, accuracy=0.129] 57%|█████▋    | 36/63 [00:05<00:05,  4.92it/s, accuracy=0.129] 57%|█████▋    | 36/63 [00:05<00:05,  4.92it/s, accuracy=0.126] 57%|█████▋    | 36/63 [00:06<00:05,  4.92it/s, accuracy=0.123] 60%|██████    | 38/63 [00:06<00:05,  4.39it/s, accuracy=0.123] 60%|██████    | 38/63 [00:06<00:05,  4.39it/s, accuracy=0.119] 60%|██████    | 38/63 [00:06<00:05,  4.39it/s, accuracy=0.116] 63%|██████▎   | 40/63 [00:06<00:05,  4.32it/s, accuracy=0.116] 63%|██████▎   | 40/63 [00:06<00:05,  4.32it/s, accuracy=0.114] 63%|██████▎   | 40/63 [00:07<00:05,  4.32it/s, accuracy=0.111] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.111] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.109] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.11]  70%|██████▉   | 44/63 [00:07<00:04,  4.19it/s, accuracy=0.11] 70%|██████▉   | 44/63 [00:07<00:04,  4.19it/s, accuracy=0.108] 70%|██████▉   | 44/63 [00:08<00:04,  4.19it/s, accuracy=0.105] 73%|███████▎  | 46/63 [00:08<00:04,  4.20it/s, accuracy=0.105] 73%|███████▎  | 46/63 [00:08<00:04,  4.20it/s, accuracy=0.103] 73%|███████▎  | 46/63 [00:08<00:04,  4.20it/s, accuracy=0.101] 76%|███████▌  | 48/63 [00:08<00:03,  4.31it/s, accuracy=0.101] 76%|███████▌  | 48/63 [00:08<00:03,  4.31it/s, accuracy=0.0989] 76%|███████▌  | 48/63 [00:09<00:03,  4.31it/s, accuracy=0.0969] 79%|███████▉  | 50/63 [00:09<00:02,  4.40it/s, accuracy=0.0969] 79%|███████▉  | 50/63 [00:09<00:02,  4.40it/s, accuracy=0.095]  79%|███████▉  | 50/63 [00:09<00:02,  4.40it/s, accuracy=0.0931] 83%|████████▎ | 52/63 [00:09<00:02,  4.45it/s, accuracy=0.0931] 83%|████████▎ | 52/63 [00:09<00:02,  4.45it/s, accuracy=0.0914] 83%|████████▎ | 52/63 [00:10<00:02,  4.45it/s, accuracy=0.0897] 86%|████████▌ | 54/63 [00:10<00:01,  4.50it/s, accuracy=0.0897] 86%|████████▌ | 54/63 [00:10<00:01,  4.50it/s, accuracy=0.0881] 86%|████████▌ | 54/63 [00:10<00:01,  4.50it/s, accuracy=0.0865] 89%|████████▉ | 56/63 [00:10<00:01,  4.55it/s, accuracy=0.0865] 89%|████████▉ | 56/63 [00:10<00:01,  4.55it/s, accuracy=0.085]  89%|████████▉ | 56/63 [00:10<00:01,  4.55it/s, accuracy=0.0835] 92%|█████████▏| 58/63 [00:10<00:01,  4.56it/s, accuracy=0.0835] 92%|█████████▏| 58/63 [00:10<00:01,  4.56it/s, accuracy=0.0821] 92%|█████████▏| 58/63 [00:11<00:01,  4.56it/s, accuracy=0.0807] 95%|█████████▌| 60/63 [00:11<00:00,  4.58it/s, accuracy=0.0807] 95%|█████████▌| 60/63 [00:11<00:00,  4.58it/s, accuracy=0.0794] 95%|█████████▌| 60/63 [00:11<00:00,  4.58it/s, accuracy=0.0781] 98%|█████████▊| 62/63 [00:11<00:00,  4.59it/s, accuracy=0.0781] 98%|█████████▊| 62/63 [00:11<00:00,  4.59it/s, accuracy=0.0775]100%|██████████| 63/63 [00:11<00:00,  5.34it/s, accuracy=0.0775]
/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/home/project/Documents/RoTTA Enhancement/RoTTA/helper.py:38: RuntimeWarning: invalid value encountered in divide
  fpr = fp / (fp + tn)
Final Accuracy : 0.0775
Average Loss: 58974791.31696776
Confusion matrix and metrics saved for model: RoTTA-P-MVN
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:09,  6.62it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:09,  6.62it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:09,  6.62it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:08,  7.31it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.56it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.56it/s, accuracy=0] 10%|▉         | 6/63 [00:01<00:07,  7.56it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.76it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.76it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.76it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.84it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.84it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.84it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.93it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.93it/s, accuracy=0] 19%|█▉        | 12/63 [00:01<00:06,  7.93it/s, accuracy=0] 22%|██▏       | 14/63 [00:01<00:06,  7.95it/s, accuracy=0] 22%|██▏       | 14/63 [00:01<00:06,  7.95it/s, accuracy=0] 22%|██▏       | 14/63 [00:02<00:06,  7.95it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.73it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.73it/s, accuracy=0] 25%|██▌       | 16/63 [00:02<00:06,  7.73it/s, accuracy=0] 29%|██▊       | 18/63 [00:02<00:05,  7.52it/s, accuracy=0] 29%|██▊       | 18/63 [00:02<00:05,  7.52it/s, accuracy=0.00822] 29%|██▊       | 18/63 [00:02<00:05,  7.52it/s, accuracy=0.0328]  32%|███▏      | 20/63 [00:02<00:05,  7.34it/s, accuracy=0.0328] 32%|███▏      | 20/63 [00:02<00:05,  7.34it/s, accuracy=0.0714] 32%|███▏      | 20/63 [00:02<00:05,  7.34it/s, accuracy=0.109]  35%|███▍      | 22/63 [00:02<00:05,  7.07it/s, accuracy=0.109] 35%|███▍      | 22/63 [00:03<00:05,  7.07it/s, accuracy=0.143] 35%|███▍      | 22/63 [00:03<00:05,  7.07it/s, accuracy=0.177] 38%|███▊      | 24/63 [00:03<00:05,  6.77it/s, accuracy=0.177] 38%|███▊      | 24/63 [00:03<00:05,  6.77it/s, accuracy=0.207] 38%|███▊      | 24/63 [00:03<00:05,  6.77it/s, accuracy=0.2]   41%|████▏     | 26/63 [00:03<00:05,  6.51it/s, accuracy=0.2] 41%|████▏     | 26/63 [00:03<00:05,  6.51it/s, accuracy=0.192] 41%|████▏     | 26/63 [00:03<00:05,  6.51it/s, accuracy=0.185] 44%|████▍     | 28/63 [00:03<00:05,  6.35it/s, accuracy=0.185] 44%|████▍     | 28/63 [00:04<00:05,  6.35it/s, accuracy=0.179] 44%|████▍     | 28/63 [00:04<00:05,  6.35it/s, accuracy=0.173] 48%|████▊     | 30/63 [00:04<00:05,  5.69it/s, accuracy=0.173] 48%|████▊     | 30/63 [00:04<00:05,  5.69it/s, accuracy=0.167] 48%|████▊     | 30/63 [00:04<00:05,  5.69it/s, accuracy=0.162] 51%|█████     | 32/63 [00:04<00:05,  5.67it/s, accuracy=0.162] 51%|█████     | 32/63 [00:04<00:05,  5.67it/s, accuracy=0.157] 51%|█████     | 32/63 [00:05<00:05,  5.67it/s, accuracy=0.153] 54%|█████▍    | 34/63 [00:05<00:05,  5.65it/s, accuracy=0.153] 54%|█████▍    | 34/63 [00:05<00:05,  5.65it/s, accuracy=0.148] 54%|█████▍    | 34/63 [00:05<00:05,  5.65it/s, accuracy=0.144] 57%|█████▋    | 36/63 [00:05<00:05,  5.07it/s, accuracy=0.144] 57%|█████▋    | 36/63 [00:05<00:05,  5.07it/s, accuracy=0.14]  57%|█████▋    | 36/63 [00:06<00:05,  5.07it/s, accuracy=0.137] 60%|██████    | 38/63 [00:06<00:05,  4.71it/s, accuracy=0.137] 60%|██████    | 38/63 [00:06<00:05,  4.71it/s, accuracy=0.133] 60%|██████    | 38/63 [00:06<00:05,  4.71it/s, accuracy=0.13]  63%|██████▎   | 40/63 [00:06<00:05,  4.27it/s, accuracy=0.13] 63%|██████▎   | 40/63 [00:06<00:05,  4.27it/s, accuracy=0.127] 63%|██████▎   | 40/63 [00:07<00:05,  4.27it/s, accuracy=0.124] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.124] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.121] 67%|██████▋   | 42/63 [00:07<00:04,  4.20it/s, accuracy=0.121] 70%|██████▉   | 44/63 [00:07<00:04,  4.34it/s, accuracy=0.121] 70%|██████▉   | 44/63 [00:07<00:04,  4.34it/s, accuracy=0.119] 70%|██████▉   | 44/63 [00:08<00:04,  4.34it/s, accuracy=0.116] 73%|███████▎  | 46/63 [00:08<00:04,  4.17it/s, accuracy=0.116] 73%|███████▎  | 46/63 [00:08<00:04,  4.17it/s, accuracy=0.114] 73%|███████▎  | 46/63 [00:08<00:04,  4.17it/s, accuracy=0.111] 76%|███████▌  | 48/63 [00:08<00:03,  4.31it/s, accuracy=0.111] 76%|███████▌  | 48/63 [00:08<00:03,  4.31it/s, accuracy=0.109] 76%|███████▌  | 48/63 [00:08<00:03,  4.31it/s, accuracy=0.107] 79%|███████▉  | 50/63 [00:08<00:02,  4.42it/s, accuracy=0.107] 79%|███████▉  | 50/63 [00:09<00:02,  4.42it/s, accuracy=0.105] 79%|███████▉  | 50/63 [00:09<00:02,  4.42it/s, accuracy=0.103] 83%|████████▎ | 52/63 [00:09<00:02,  4.50it/s, accuracy=0.103] 83%|████████▎ | 52/63 [00:09<00:02,  4.50it/s, accuracy=0.101] 83%|████████▎ | 52/63 [00:09<00:02,  4.50it/s, accuracy=0.099] 86%|████████▌ | 54/63 [00:09<00:01,  4.55it/s, accuracy=0.099] 86%|████████▌ | 54/63 [00:09<00:01,  4.55it/s, accuracy=0.0972] 86%|████████▌ | 54/63 [00:10<00:01,  4.55it/s, accuracy=0.0954] 89%|████████▉ | 56/63 [00:10<00:01,  4.60it/s, accuracy=0.0954] 89%|████████▉ | 56/63 [00:10<00:01,  4.60it/s, accuracy=0.0938] 89%|████████▉ | 56/63 [00:10<00:01,  4.60it/s, accuracy=0.0921] 92%|█████████▏| 58/63 [00:10<00:01,  4.62it/s, accuracy=0.0921] 92%|█████████▏| 58/63 [00:10<00:01,  4.62it/s, accuracy=0.0906] 92%|█████████▏| 58/63 [00:11<00:01,  4.62it/s, accuracy=0.0891] 95%|█████████▌| 60/63 [00:11<00:00,  4.64it/s, accuracy=0.0891] 95%|█████████▌| 60/63 [00:11<00:00,  4.64it/s, accuracy=0.0876] 95%|█████████▌| 60/63 [00:11<00:00,  4.64it/s, accuracy=0.0862] 98%|█████████▊| 62/63 [00:11<00:00,  4.65it/s, accuracy=0.0862] 98%|█████████▊| 62/63 [00:11<00:00,  4.65it/s, accuracy=0.0855]100%|██████████| 63/63 [00:11<00:00,  5.46it/s, accuracy=0.0855]
/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/home/project/Documents/RoTTA Enhancement/RoTTA/helper.py:38: RuntimeWarning: invalid value encountered in divide
  fpr = fp / (fp + tn)
Final Accuracy : 0.0855
Average Loss: 58856191.63745702
Confusion matrix and metrics saved for model: RoTTA-P-MVN
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06,  9.15it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06,  9.15it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06,  9.15it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:07,  7.93it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:07,  7.93it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:07,  7.93it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.74it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:07,  7.74it/s, accuracy=0] 10%|▉         | 6/63 [00:01<00:07,  7.74it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.63it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.63it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:07,  7.63it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.69it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.69it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.69it/s, accuracy=0.00521] 19%|█▉        | 12/63 [00:01<00:06,  7.66it/s, accuracy=0.00521] 19%|█▉        | 12/63 [00:01<00:06,  7.66it/s, accuracy=0.00481] 19%|█▉        | 12/63 [00:01<00:06,  7.66it/s, accuracy=0.00446] 22%|██▏       | 14/63 [00:01<00:06,  7.31it/s, accuracy=0.00446] 22%|██▏       | 14/63 [00:01<00:06,  7.31it/s, accuracy=0.00417] 22%|██▏       | 14/63 [00:02<00:06,  7.31it/s, accuracy=0.00391] 25%|██▌       | 16/63 [00:02<00:06,  7.00it/s, accuracy=0.00391] 25%|██▌       | 16/63 [00:02<00:06,  7.00it/s, accuracy=0.00368] 25%|██▌       | 16/63 [00:02<00:06,  7.00it/s, accuracy=0.00347] 29%|██▊       | 18/63 [00:02<00:06,  6.76it/s, accuracy=0.00347] 29%|██▊       | 18/63 [00:02<00:06,  6.76it/s, accuracy=0.00987] 29%|██▊       | 18/63 [00:02<00:06,  6.76it/s, accuracy=0.0328]  32%|███▏      | 20/63 [00:02<00:06,  6.50it/s, accuracy=0.0328] 32%|███▏      | 20/63 [00:02<00:06,  6.50it/s, accuracy=0.061]  32%|███▏      | 20/63 [00:03<00:06,  6.50it/s, accuracy=0.0881] 35%|███▍      | 22/63 [00:03<00:06,  6.22it/s, accuracy=0.0881] 35%|███▍      | 22/63 [00:03<00:06,  6.22it/s, accuracy=0.117]  37%|███▋      | 23/63 [00:03<00:06,  6.48it/s, accuracy=0.117] 37%|███▋      | 23/63 [00:03<00:06,  6.48it/s, accuracy=0.142] 38%|███▊      | 24/63 [00:03<00:06,  5.58it/s, accuracy=0.142] 38%|███▊      | 24/63 [00:03<00:06,  5.58it/s, accuracy=0.165] 38%|███▊      | 24/63 [00:03<00:06,  5.58it/s, accuracy=0.159] 41%|████▏     | 26/63 [00:03<00:06,  5.58it/s, accuracy=0.159] 41%|████▏     | 26/63 [00:04<00:06,  5.58it/s, accuracy=0.153] 41%|████▏     | 26/63 [00:04<00:06,  5.58it/s, accuracy=0.147] 44%|████▍     | 28/63 [00:04<00:06,  5.56it/s, accuracy=0.147] 44%|████▍     | 28/63 [00:04<00:06,  5.56it/s, accuracy=0.142] 44%|████▍     | 28/63 [00:04<00:06,  5.56it/s, accuracy=0.138] 48%|████▊     | 30/63 [00:04<00:06,  5.30it/s, accuracy=0.138] 48%|████▊     | 30/63 [00:04<00:06,  5.30it/s, accuracy=0.133] 48%|████▊     | 30/63 [00:05<00:06,  5.30it/s, accuracy=0.129] 51%|█████     | 32/63 [00:05<00:06,  5.05it/s, accuracy=0.129] 51%|█████     | 32/63 [00:05<00:06,  5.05it/s, accuracy=0.125] 51%|█████     | 32/63 [00:05<00:06,  5.05it/s, accuracy=0.121] 54%|█████▍    | 34/63 [00:05<00:06,  4.73it/s, accuracy=0.121] 54%|█████▍    | 34/63 [00:05<00:06,  4.73it/s, accuracy=0.118] 54%|█████▍    | 34/63 [00:06<00:06,  4.73it/s, accuracy=0.115] 57%|█████▋    | 36/63 [00:06<00:05,  4.69it/s, accuracy=0.115] 57%|█████▋    | 36/63 [00:06<00:05,  4.69it/s, accuracy=0.111] 57%|█████▋    | 36/63 [00:06<00:05,  4.69it/s, accuracy=0.109] 60%|██████    | 38/63 [00:06<00:05,  4.57it/s, accuracy=0.109] 60%|██████    | 38/63 [00:06<00:05,  4.57it/s, accuracy=0.106] 62%|██████▏   | 39/63 [00:06<00:04,  5.05it/s, accuracy=0.106] 62%|██████▏   | 39/63 [00:06<00:04,  5.05it/s, accuracy=0.103] 63%|██████▎   | 40/63 [00:06<00:05,  4.29it/s, accuracy=0.103] 63%|██████▎   | 40/63 [00:07<00:05,  4.29it/s, accuracy=0.101] 63%|██████▎   | 40/63 [00:07<00:05,  4.29it/s, accuracy=0.0982] 67%|██████▋   | 42/63 [00:07<00:04,  4.39it/s, accuracy=0.0982] 67%|██████▋   | 42/63 [00:07<00:04,  4.39it/s, accuracy=0.0959] 67%|██████▋   | 42/63 [00:07<00:04,  4.39it/s, accuracy=0.0959] 70%|██████▉   | 44/63 [00:07<00:04,  4.47it/s, accuracy=0.0959] 70%|██████▉   | 44/63 [00:07<00:04,  4.47it/s, accuracy=0.0938] 71%|███████▏  | 45/63 [00:07<00:03,  4.93it/s, accuracy=0.0938] 71%|███████▏  | 45/63 [00:08<00:03,  4.93it/s, accuracy=0.0917] 73%|███████▎  | 46/63 [00:08<00:04,  4.08it/s, accuracy=0.0917] 73%|███████▎  | 46/63 [00:08<00:04,  4.08it/s, accuracy=0.0898] 73%|███████▎  | 46/63 [00:08<00:04,  4.08it/s, accuracy=0.0879] 76%|███████▌  | 48/63 [00:08<00:03,  4.24it/s, accuracy=0.0879] 76%|███████▌  | 48/63 [00:08<00:03,  4.24it/s, accuracy=0.0861] 76%|███████▌  | 48/63 [00:09<00:03,  4.24it/s, accuracy=0.0844] 79%|███████▉  | 50/63 [00:09<00:02,  4.34it/s, accuracy=0.0844] 79%|███████▉  | 50/63 [00:09<00:02,  4.34it/s, accuracy=0.0827] 79%|███████▉  | 50/63 [00:09<00:02,  4.34it/s, accuracy=0.0811] 83%|████████▎ | 52/63 [00:09<00:02,  4.23it/s, accuracy=0.0811] 83%|████████▎ | 52/63 [00:09<00:02,  4.23it/s, accuracy=0.0796] 83%|████████▎ | 52/63 [00:10<00:02,  4.23it/s, accuracy=0.0781] 86%|████████▌ | 54/63 [00:10<00:02,  4.29it/s, accuracy=0.0781] 86%|████████▌ | 54/63 [00:10<00:02,  4.29it/s, accuracy=0.0767] 86%|████████▌ | 54/63 [00:10<00:02,  4.29it/s, accuracy=0.0753] 89%|████████▉ | 56/63 [00:10<00:01,  4.33it/s, accuracy=0.0753] 89%|████████▉ | 56/63 [00:10<00:01,  4.33it/s, accuracy=0.074]  89%|████████▉ | 56/63 [00:11<00:01,  4.33it/s, accuracy=0.0727] 92%|█████████▏| 58/63 [00:11<00:01,  4.36it/s, accuracy=0.0727] 92%|█████████▏| 58/63 [00:11<00:01,  4.36it/s, accuracy=0.0715] 92%|█████████▏| 58/63 [00:11<00:01,  4.36it/s, accuracy=0.0703] 95%|█████████▌| 60/63 [00:11<00:00,  4.38it/s, accuracy=0.0703] 95%|█████████▌| 60/63 [00:11<00:00,  4.38it/s, accuracy=0.0692] 95%|█████████▌| 60/63 [00:12<00:00,  4.38it/s, accuracy=0.068]  98%|█████████▊| 62/63 [00:12<00:00,  4.34it/s, accuracy=0.068] 98%|█████████▊| 62/63 [00:12<00:00,  4.34it/s, accuracy=0.0675]100%|██████████| 63/63 [00:12<00:00,  5.21it/s, accuracy=0.0675]
/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/home/project/Documents/RoTTA Enhancement/RoTTA/helper.py:38: RuntimeWarning: invalid value encountered in divide
  fpr = fp / (fp + tn)
Final Accuracy : 0.0675
Average Loss: 57800261.12955167
Confusion matrix and metrics saved for model: RoTTA-P-MVN
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06, 10.09it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06, 10.09it/s, accuracy=0]  3%|▎         | 2/63 [00:00<00:06, 10.09it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:06,  8.91it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:06,  8.91it/s, accuracy=0]  6%|▋         | 4/63 [00:00<00:06,  8.91it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:06,  8.42it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:06,  8.42it/s, accuracy=0] 10%|▉         | 6/63 [00:00<00:06,  8.42it/s, accuracy=0] 13%|█▎        | 8/63 [00:00<00:06,  8.23it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:06,  8.23it/s, accuracy=0] 13%|█▎        | 8/63 [00:01<00:06,  8.23it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.96it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.96it/s, accuracy=0] 16%|█▌        | 10/63 [00:01<00:06,  7.96it/s, accuracy=0.0104] 19%|█▉        | 12/63 [00:01<00:06,  7.48it/s, accuracy=0.0104] 19%|█▉        | 12/63 [00:01<00:06,  7.48it/s, accuracy=0.00962] 19%|█▉        | 12/63 [00:01<00:06,  7.48it/s, accuracy=0.00893] 22%|██▏       | 14/63 [00:01<00:06,  7.32it/s, accuracy=0.00893] 22%|██▏       | 14/63 [00:01<00:06,  7.32it/s, accuracy=0.00833] 22%|██▏       | 14/63 [00:02<00:06,  7.32it/s, accuracy=0.00781] 25%|██▌       | 16/63 [00:02<00:06,  7.06it/s, accuracy=0.00781] 25%|██▌       | 16/63 [00:02<00:06,  7.06it/s, accuracy=0.00735] 25%|██▌       | 16/63 [00:02<00:06,  7.06it/s, accuracy=0.00694] 29%|██▊       | 18/63 [00:02<00:06,  6.72it/s, accuracy=0.00694] 29%|██▊       | 18/63 [00:02<00:06,  6.72it/s, accuracy=0.0132]  29%|██▊       | 18/63 [00:02<00:06,  6.72it/s, accuracy=0.0312] 32%|███▏      | 20/63 [00:02<00:06,  6.52it/s, accuracy=0.0312] 32%|███▏      | 20/63 [00:02<00:06,  6.52it/s, accuracy=0.061]  32%|███▏      | 20/63 [00:03<00:06,  6.52it/s, accuracy=0.0923] 35%|███▍      | 22/63 [00:03<00:06,  6.26it/s, accuracy=0.0923] 35%|███▍      | 22/63 [00:03<00:06,  6.26it/s, accuracy=0.124]  35%|███▍      | 22/63 [00:03<00:06,  6.26it/s, accuracy=0.155] 38%|███▊      | 24/63 [00:03<00:06,  5.93it/s, accuracy=0.155] 38%|███▊      | 24/63 [00:03<00:06,  5.93it/s, accuracy=0.181] 38%|███▊      | 24/63 [00:03<00:06,  5.93it/s, accuracy=0.174] 41%|████▏     | 26/63 [00:03<00:06,  5.58it/s, accuracy=0.174] 41%|████▏     | 26/63 [00:03<00:06,  5.58it/s, accuracy=0.168] 41%|████▏     | 26/63 [00:04<00:06,  5.58it/s, accuracy=0.162] 44%|████▍     | 28/63 [00:04<00:06,  5.46it/s, accuracy=0.162] 44%|████▍     | 28/63 [00:04<00:06,  5.46it/s, accuracy=0.156] 44%|████▍     | 28/63 [00:04<00:06,  5.46it/s, accuracy=0.151] 48%|████▊     | 30/63 [00:04<00:06,  5.40it/s, accuracy=0.151] 48%|████▊     | 30/63 [00:04<00:06,  5.40it/s, accuracy=0.146] 48%|████▊     | 30/63 [00:05<00:06,  5.40it/s, accuracy=0.142] 51%|█████     | 32/63 [00:05<00:05,  5.26it/s, accuracy=0.142] 51%|█████     | 32/63 [00:05<00:05,  5.26it/s, accuracy=0.137] 51%|█████     | 32/63 [00:05<00:05,  5.26it/s, accuracy=0.133] 54%|█████▍    | 34/63 [00:05<00:05,  5.12it/s, accuracy=0.133] 54%|█████▍    | 34/63 [00:05<00:05,  5.12it/s, accuracy=0.129] 54%|█████▍    | 34/63 [00:05<00:05,  5.12it/s, accuracy=0.126] 57%|█████▋    | 36/63 [00:05<00:05,  4.94it/s, accuracy=0.126] 57%|█████▋    | 36/63 [00:05<00:05,  4.94it/s, accuracy=0.122] 57%|█████▋    | 36/63 [00:06<00:05,  4.94it/s, accuracy=0.119] 60%|██████    | 38/63 [00:06<00:05,  4.83it/s, accuracy=0.119] 60%|██████    | 38/63 [00:06<00:05,  4.83it/s, accuracy=0.116] 60%|██████    | 38/63 [00:06<00:05,  4.83it/s, accuracy=0.113] 63%|██████▎   | 40/63 [00:06<00:04,  4.74it/s, accuracy=0.113] 63%|██████▎   | 40/63 [00:06<00:04,  4.74it/s, accuracy=0.111] 63%|██████▎   | 40/63 [00:07<00:04,  4.74it/s, accuracy=0.108] 67%|██████▋   | 42/63 [00:07<00:04,  4.66it/s, accuracy=0.108] 67%|██████▋   | 42/63 [00:07<00:04,  4.66it/s, accuracy=0.106] 68%|██████▊   | 43/63 [00:07<00:03,  5.12it/s, accuracy=0.106] 68%|██████▊   | 43/63 [00:07<00:03,  5.12it/s, accuracy=0.107] 70%|██████▉   | 44/63 [00:07<00:04,  4.31it/s, accuracy=0.107] 70%|██████▉   | 44/63 [00:07<00:04,  4.31it/s, accuracy=0.104] 70%|██████▉   | 44/63 [00:08<00:04,  4.31it/s, accuracy=0.102] 73%|███████▎  | 46/63 [00:08<00:03,  4.34it/s, accuracy=0.102] 73%|███████▎  | 46/63 [00:08<00:03,  4.34it/s, accuracy=0.0997] 73%|███████▎  | 46/63 [00:08<00:03,  4.34it/s, accuracy=0.0977] 76%|███████▌  | 48/63 [00:08<00:03,  4.41it/s, accuracy=0.0977] 76%|███████▌  | 48/63 [00:08<00:03,  4.41it/s, accuracy=0.0957] 78%|███████▊  | 49/63 [00:08<00:02,  4.96it/s, accuracy=0.0957] 78%|███████▊  | 49/63 [00:09<00:02,  4.96it/s, accuracy=0.0938] 79%|███████▉  | 50/63 [00:09<00:03,  4.21it/s, accuracy=0.0938] 79%|███████▉  | 50/63 [00:09<00:03,  4.21it/s, accuracy=0.0919] 79%|███████▉  | 50/63 [00:09<00:03,  4.21it/s, accuracy=0.0901] 83%|████████▎ | 52/63 [00:09<00:02,  4.36it/s, accuracy=0.0901] 83%|████████▎ | 52/63 [00:09<00:02,  4.36it/s, accuracy=0.0884] 83%|████████▎ | 52/63 [00:09<00:02,  4.36it/s, accuracy=0.0868] 86%|████████▌ | 54/63 [00:09<00:02,  4.44it/s, accuracy=0.0868] 86%|████████▌ | 54/63 [00:10<00:02,  4.44it/s, accuracy=0.0852] 86%|████████▌ | 54/63 [00:10<00:02,  4.44it/s, accuracy=0.0837] 89%|████████▉ | 56/63 [00:10<00:01,  4.49it/s, accuracy=0.0837] 89%|████████▉ | 56/63 [00:10<00:01,  4.49it/s, accuracy=0.0822] 89%|████████▉ | 56/63 [00:10<00:01,  4.49it/s, accuracy=0.0808] 92%|█████████▏| 58/63 [00:10<00:01,  4.44it/s, accuracy=0.0808] 92%|█████████▏| 58/63 [00:10<00:01,  4.44it/s, accuracy=0.0794] 92%|█████████▏| 58/63 [00:11<00:01,  4.44it/s, accuracy=0.0781] 95%|█████████▌| 60/63 [00:11<00:00,  4.44it/s, accuracy=0.0781] 95%|█████████▌| 60/63 [00:11<00:00,  4.44it/s, accuracy=0.0768] 95%|█████████▌| 60/63 [00:11<00:00,  4.44it/s, accuracy=0.0756] 98%|█████████▊| 62/63 [00:11<00:00,  4.49it/s, accuracy=0.0756] 98%|█████████▊| 62/63 [00:11<00:00,  4.49it/s, accuracy=0.075] 100%|██████████| 63/63 [00:11<00:00,  5.35it/s, accuracy=0.075]
/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/home/project/Documents/RoTTA Enhancement/RoTTA/helper.py:38: RuntimeWarning: invalid value encountered in divide
  fpr = fp / (fp + tn)
Final Accuracy : 0.075
Average Loss: 60291759.656564765
Confusion matrix and metrics saved for model: RoTTA-P-MVN
