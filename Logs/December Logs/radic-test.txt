../Attacks/CIFAR-10/ResNet18/Clean
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.938]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.906]  3%|▎         | 2/63 [00:00<00:07,  8.39it/s, accuracy=0.906]  3%|▎         | 2/63 [00:00<00:07,  8.39it/s, accuracy=0.927]  3%|▎         | 2/63 [00:00<00:07,  8.39it/s, accuracy=0.891]  6%|▋         | 4/63 [00:00<00:06,  8.43it/s, accuracy=0.891]  6%|▋         | 4/63 [00:00<00:06,  8.43it/s, accuracy=0.9]    6%|▋         | 4/63 [00:00<00:06,  8.43it/s, accuracy=0.906] 10%|▉         | 6/63 [00:00<00:07,  8.13it/s, accuracy=0.906] 10%|▉         | 6/63 [00:00<00:07,  8.13it/s, accuracy=0.915] 10%|▉         | 6/63 [00:01<00:07,  8.13it/s, accuracy=0.922] 13%|█▎        | 8/63 [00:01<00:08,  6.50it/s, accuracy=0.922] 13%|█▎        | 8/63 [00:01<00:08,  6.50it/s, accuracy=0.924] 13%|█▎        | 8/63 [00:01<00:08,  6.50it/s, accuracy=0.925] 16%|█▌        | 10/63 [00:01<00:08,  6.26it/s, accuracy=0.925] 16%|█▌        | 10/63 [00:01<00:08,  6.26it/s, accuracy=0.929] 16%|█▌        | 10/63 [00:01<00:08,  6.26it/s, accuracy=0.93]  19%|█▉        | 12/63 [00:01<00:08,  6.01it/s, accuracy=0.93] 19%|█▉        | 12/63 [00:01<00:08,  6.01it/s, accuracy=0.918] 19%|█▉        | 12/63 [00:02<00:08,  6.01it/s, accuracy=0.917] 22%|██▏       | 14/63 [00:02<00:09,  5.32it/s, accuracy=0.917] 22%|██▏       | 14/63 [00:02<00:09,  5.32it/s, accuracy=0.919] 22%|██▏       | 14/63 [00:02<00:09,  5.32it/s, accuracy=0.912] 25%|██▌       | 16/63 [00:02<00:09,  5.06it/s, accuracy=0.912] 25%|██▌       | 16/63 [00:02<00:09,  5.06it/s, accuracy=0.914] 25%|██▌       | 16/63 [00:03<00:09,  5.06it/s, accuracy=0.911] 29%|██▊       | 18/63 [00:03<00:09,  4.91it/s, accuracy=0.911] 29%|██▊       | 18/63 [00:03<00:09,  4.91it/s, accuracy=0.906] 29%|██▊       | 18/63 [00:03<00:09,  4.91it/s, accuracy=0.894] 32%|███▏      | 20/63 [00:03<00:09,  4.67it/s, accuracy=0.894] 32%|███▏      | 20/63 [00:03<00:09,  4.67it/s, accuracy=0.887] 32%|███▏      | 20/63 [00:04<00:09,  4.67it/s, accuracy=0.878] 35%|███▍      | 22/63 [00:04<00:09,  4.49it/s, accuracy=0.878] 35%|███▍      | 22/63 [00:04<00:09,  4.49it/s, accuracy=0.868] 35%|███▍      | 22/63 [00:04<00:09,  4.49it/s, accuracy=0.862] 38%|███▊      | 24/63 [00:04<00:09,  4.16it/s, accuracy=0.862] 38%|███▊      | 24/63 [00:04<00:09,  4.16it/s, accuracy=0.856] 38%|███▊      | 24/63 [00:05<00:09,  4.16it/s, accuracy=0.856] 41%|████▏     | 26/63 [00:05<00:08,  4.15it/s, accuracy=0.856] 41%|████▏     | 26/63 [00:05<00:08,  4.15it/s, accuracy=0.858] 41%|████▏     | 26/63 [00:05<00:08,  4.15it/s, accuracy=0.86]  44%|████▍     | 28/63 [00:05<00:08,  3.97it/s, accuracy=0.86] 44%|████▍     | 28/63 [00:05<00:08,  3.97it/s, accuracy=0.859] 44%|████▍     | 28/63 [00:06<00:08,  3.97it/s, accuracy=0.859] 48%|████▊     | 30/63 [00:06<00:08,  4.09it/s, accuracy=0.859] 48%|████▊     | 30/63 [00:06<00:08,  4.09it/s, accuracy=0.862] 48%|████▊     | 30/63 [00:06<00:08,  4.09it/s, accuracy=0.863] 51%|█████     | 32/63 [00:06<00:07,  4.16it/s, accuracy=0.863] 51%|█████     | 32/63 [00:06<00:07,  4.16it/s, accuracy=0.865] 51%|█████     | 32/63 [00:07<00:07,  4.16it/s, accuracy=0.865] 54%|█████▍    | 34/63 [00:07<00:07,  4.13it/s, accuracy=0.865] 54%|█████▍    | 34/63 [00:07<00:07,  4.13it/s, accuracy=0.865] 54%|█████▍    | 34/63 [00:07<00:07,  4.13it/s, accuracy=0.865] 57%|█████▋    | 36/63 [00:07<00:06,  4.20it/s, accuracy=0.865] 57%|█████▋    | 36/63 [00:07<00:06,  4.20it/s, accuracy=0.867] 57%|█████▋    | 36/63 [00:08<00:06,  4.20it/s, accuracy=0.868] 60%|██████    | 38/63 [00:08<00:05,  4.28it/s, accuracy=0.868] 60%|██████    | 38/63 [00:08<00:05,  4.28it/s, accuracy=0.869] 60%|██████    | 38/63 [00:08<00:05,  4.28it/s, accuracy=0.871] 63%|██████▎   | 40/63 [00:08<00:05,  4.33it/s, accuracy=0.871] 63%|██████▎   | 40/63 [00:08<00:05,  4.33it/s, accuracy=0.873] 63%|██████▎   | 40/63 [00:08<00:05,  4.33it/s, accuracy=0.875] 67%|██████▋   | 42/63 [00:08<00:04,  4.36it/s, accuracy=0.875] 67%|██████▋   | 42/63 [00:09<00:04,  4.36it/s, accuracy=0.878] 67%|██████▋   | 42/63 [00:09<00:04,  4.36it/s, accuracy=0.878] 70%|██████▉   | 44/63 [00:09<00:04,  4.24it/s, accuracy=0.878] 70%|██████▉   | 44/63 [00:09<00:04,  4.24it/s, accuracy=0.881] 70%|██████▉   | 44/63 [00:09<00:04,  4.24it/s, accuracy=0.882] 73%|███████▎  | 46/63 [00:09<00:03,  4.28it/s, accuracy=0.882] 73%|███████▎  | 46/63 [00:09<00:03,  4.28it/s, accuracy=0.882] 73%|███████▎  | 46/63 [00:10<00:03,  4.28it/s, accuracy=0.883] 76%|███████▌  | 48/63 [00:10<00:03,  4.32it/s, accuracy=0.883] 76%|███████▌  | 48/63 [00:10<00:03,  4.32it/s, accuracy=0.884] 76%|███████▌  | 48/63 [00:10<00:03,  4.32it/s, accuracy=0.886] 79%|███████▉  | 50/63 [00:10<00:02,  4.36it/s, accuracy=0.886] 79%|███████▉  | 50/63 [00:10<00:02,  4.36it/s, accuracy=0.887] 79%|███████▉  | 50/63 [00:11<00:02,  4.36it/s, accuracy=0.888] 83%|████████▎ | 52/63 [00:11<00:02,  4.38it/s, accuracy=0.888] 83%|████████▎ | 52/63 [00:11<00:02,  4.38it/s, accuracy=0.889] 83%|████████▎ | 52/63 [00:11<00:02,  4.38it/s, accuracy=0.889] 86%|████████▌ | 54/63 [00:11<00:02,  4.40it/s, accuracy=0.889] 86%|████████▌ | 54/63 [00:11<00:02,  4.40it/s, accuracy=0.891] 86%|████████▌ | 54/63 [00:12<00:02,  4.40it/s, accuracy=0.892] 89%|████████▉ | 56/63 [00:12<00:01,  4.41it/s, accuracy=0.892] 89%|████████▉ | 56/63 [00:12<00:01,  4.41it/s, accuracy=0.893] 89%|████████▉ | 56/63 [00:12<00:01,  4.41it/s, accuracy=0.894] 92%|█████████▏| 58/63 [00:12<00:01,  4.42it/s, accuracy=0.894] 92%|█████████▏| 58/63 [00:12<00:01,  4.42it/s, accuracy=0.893] 92%|█████████▏| 58/63 [00:13<00:01,  4.42it/s, accuracy=0.895] 95%|█████████▌| 60/63 [00:13<00:00,  4.43it/s, accuracy=0.895] 95%|█████████▌| 60/63 [00:13<00:00,  4.43it/s, accuracy=0.897] 95%|█████████▌| 60/63 [00:13<00:00,  4.43it/s, accuracy=0.898] 98%|█████████▊| 62/63 [00:13<00:00,  4.43it/s, accuracy=0.898] 98%|█████████▊| 62/63 [00:13<00:00,  4.43it/s, accuracy=0.898]100%|██████████| 63/63 [00:13<00:00,  4.65it/s, accuracy=0.898]
Final Accuracy : 0.898
Average Loss: 0.013299656204530039
Confusion matrix and metrics saved for model: RoTTA+FOA(ResNet18)-cifar10
../Attacks/CIFAR-10/ResNet18/FGSM
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.156]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.203]  3%|▎         | 2/63 [00:00<00:06, 10.08it/s, accuracy=0.203]  3%|▎         | 2/63 [00:00<00:06, 10.08it/s, accuracy=0.271]  3%|▎         | 2/63 [00:00<00:06, 10.08it/s, accuracy=0.312]  6%|▋         | 4/63 [00:00<00:07,  8.31it/s, accuracy=0.312]  6%|▋         | 4/63 [00:00<00:07,  8.31it/s, accuracy=0.312]  6%|▋         | 4/63 [00:00<00:07,  8.31it/s, accuracy=0.318] 10%|▉         | 6/63 [00:00<00:08,  6.80it/s, accuracy=0.318] 10%|▉         | 6/63 [00:00<00:08,  6.80it/s, accuracy=0.308] 10%|▉         | 6/63 [00:01<00:08,  6.80it/s, accuracy=0.316] 13%|█▎        | 8/63 [00:01<00:09,  5.79it/s, accuracy=0.316] 13%|█▎        | 8/63 [00:01<00:09,  5.79it/s, accuracy=0.323] 13%|█▎        | 8/63 [00:01<00:09,  5.79it/s, accuracy=0.328] 16%|█▌        | 10/63 [00:01<00:10,  5.29it/s, accuracy=0.328] 16%|█▌        | 10/63 [00:01<00:10,  5.29it/s, accuracy=0.335] 16%|█▌        | 10/63 [00:02<00:10,  5.29it/s, accuracy=0.336] 19%|█▉        | 12/63 [00:02<00:10,  4.95it/s, accuracy=0.336] 19%|█▉        | 12/63 [00:02<00:10,  4.95it/s, accuracy=0.337] 19%|█▉        | 12/63 [00:02<00:10,  4.95it/s, accuracy=0.335] 22%|██▏       | 14/63 [00:02<00:10,  4.78it/s, accuracy=0.335] 22%|██▏       | 14/63 [00:02<00:10,  4.78it/s, accuracy=0.329] 22%|██▏       | 14/63 [00:03<00:10,  4.78it/s, accuracy=0.324] 25%|██▌       | 16/63 [00:03<00:10,  4.67it/s, accuracy=0.324] 25%|██▌       | 16/63 [00:03<00:10,  4.67it/s, accuracy=0.322] 25%|██▌       | 16/63 [00:03<00:10,  4.67it/s, accuracy=0.316] 29%|██▊       | 18/63 [00:03<00:09,  4.61it/s, accuracy=0.316] 29%|██▊       | 18/63 [00:03<00:09,  4.61it/s, accuracy=0.316] 29%|██▊       | 18/63 [00:03<00:09,  4.61it/s, accuracy=0.316] 32%|███▏      | 20/63 [00:03<00:09,  4.56it/s, accuracy=0.316] 32%|███▏      | 20/63 [00:04<00:09,  4.56it/s, accuracy=0.327] 32%|███▏      | 20/63 [00:04<00:09,  4.56it/s, accuracy=0.332] 35%|███▍      | 22/63 [00:04<00:09,  4.53it/s, accuracy=0.332] 35%|███▍      | 22/63 [00:04<00:09,  4.53it/s, accuracy=0.336] 35%|███▍      | 22/63 [00:04<00:09,  4.53it/s, accuracy=0.339] 38%|███▊      | 24/63 [00:04<00:08,  4.51it/s, accuracy=0.339] 38%|███▊      | 24/63 [00:04<00:08,  4.51it/s, accuracy=0.344] 38%|███▊      | 24/63 [00:05<00:08,  4.51it/s, accuracy=0.343] 41%|████▏     | 26/63 [00:05<00:08,  4.46it/s, accuracy=0.343] 41%|████▏     | 26/63 [00:05<00:08,  4.46it/s, accuracy=0.35]  41%|████▏     | 26/63 [00:05<00:08,  4.46it/s, accuracy=0.352] 44%|████▍     | 28/63 [00:05<00:07,  4.45it/s, accuracy=0.352] 44%|████▍     | 28/63 [00:05<00:07,  4.45it/s, accuracy=0.351] 44%|████▍     | 28/63 [00:06<00:07,  4.45it/s, accuracy=0.355] 48%|████▊     | 30/63 [00:06<00:07,  4.46it/s, accuracy=0.355] 48%|████▊     | 30/63 [00:06<00:07,  4.46it/s, accuracy=0.351] 48%|████▊     | 30/63 [00:06<00:07,  4.46it/s, accuracy=0.352] 51%|█████     | 32/63 [00:06<00:06,  4.45it/s, accuracy=0.352] 51%|█████     | 32/63 [00:06<00:06,  4.45it/s, accuracy=0.364] 51%|█████     | 32/63 [00:07<00:06,  4.45it/s, accuracy=0.37]  54%|█████▍    | 34/63 [00:07<00:06,  4.46it/s, accuracy=0.37] 54%|█████▍    | 34/63 [00:07<00:06,  4.46it/s, accuracy=0.374] 54%|█████▍    | 34/63 [00:07<00:06,  4.46it/s, accuracy=0.374] 57%|█████▋    | 36/63 [00:07<00:06,  4.46it/s, accuracy=0.374] 57%|█████▋    | 36/63 [00:07<00:06,  4.46it/s, accuracy=0.375] 57%|█████▋    | 36/63 [00:07<00:06,  4.46it/s, accuracy=0.377] 60%|██████    | 38/63 [00:07<00:05,  4.46it/s, accuracy=0.377] 60%|██████    | 38/63 [00:08<00:05,  4.46it/s, accuracy=0.38]  60%|██████    | 38/63 [00:08<00:05,  4.46it/s, accuracy=0.384] 63%|██████▎   | 40/63 [00:08<00:05,  4.46it/s, accuracy=0.384] 63%|██████▎   | 40/63 [00:08<00:05,  4.46it/s, accuracy=0.386] 63%|██████▎   | 40/63 [00:08<00:05,  4.46it/s, accuracy=0.391] 67%|██████▋   | 42/63 [00:08<00:04,  4.47it/s, accuracy=0.391] 67%|██████▋   | 42/63 [00:08<00:04,  4.47it/s, accuracy=0.396] 67%|██████▋   | 42/63 [00:09<00:04,  4.47it/s, accuracy=0.4]   70%|██████▉   | 44/63 [00:09<00:04,  4.46it/s, accuracy=0.4] 70%|██████▉   | 44/63 [00:09<00:04,  4.46it/s, accuracy=0.404] 70%|██████▉   | 44/63 [00:09<00:04,  4.46it/s, accuracy=0.41]  73%|███████▎  | 46/63 [00:09<00:03,  4.45it/s, accuracy=0.41] 73%|███████▎  | 46/63 [00:09<00:03,  4.45it/s, accuracy=0.415] 73%|███████▎  | 46/63 [00:10<00:03,  4.45it/s, accuracy=0.417] 76%|███████▌  | 48/63 [00:10<00:03,  4.43it/s, accuracy=0.417] 76%|███████▌  | 48/63 [00:10<00:03,  4.43it/s, accuracy=0.42]  76%|███████▌  | 48/63 [00:10<00:03,  4.43it/s, accuracy=0.422] 79%|███████▉  | 50/63 [00:10<00:02,  4.44it/s, accuracy=0.422] 79%|███████▉  | 50/63 [00:10<00:02,  4.44it/s, accuracy=0.425] 79%|███████▉  | 50/63 [00:11<00:02,  4.44it/s, accuracy=0.427] 83%|████████▎ | 52/63 [00:11<00:02,  4.45it/s, accuracy=0.427] 83%|████████▎ | 52/63 [00:11<00:02,  4.45it/s, accuracy=0.431] 83%|████████▎ | 52/63 [00:11<00:02,  4.45it/s, accuracy=0.433] 86%|████████▌ | 54/63 [00:11<00:02,  4.45it/s, accuracy=0.433] 86%|████████▌ | 54/63 [00:11<00:02,  4.45it/s, accuracy=0.437] 86%|████████▌ | 54/63 [00:12<00:02,  4.45it/s, accuracy=0.436] 89%|████████▉ | 56/63 [00:12<00:01,  4.46it/s, accuracy=0.436] 89%|████████▉ | 56/63 [00:12<00:01,  4.46it/s, accuracy=0.442] 89%|████████▉ | 56/63 [00:12<00:01,  4.46it/s, accuracy=0.447] 92%|█████████▏| 58/63 [00:12<00:01,  4.46it/s, accuracy=0.447] 92%|█████████▏| 58/63 [00:12<00:01,  4.46it/s, accuracy=0.449] 92%|█████████▏| 58/63 [00:12<00:01,  4.46it/s, accuracy=0.456] 95%|█████████▌| 60/63 [00:12<00:00,  4.46it/s, accuracy=0.456] 95%|█████████▌| 60/63 [00:12<00:00,  4.46it/s, accuracy=0.457] 95%|█████████▌| 60/63 [00:13<00:00,  4.46it/s, accuracy=0.46]  98%|█████████▊| 62/63 [00:13<00:00,  4.46it/s, accuracy=0.46] 98%|█████████▊| 62/63 [00:13<00:00,  4.46it/s, accuracy=0.462]100%|██████████| 63/63 [00:13<00:00,  4.70it/s, accuracy=0.462]
Final Accuracy : 0.462
Average Loss: 0.07741392663121223
Confusion matrix and metrics saved for model: RoTTA+FOA(ResNet18)-cifar10
../Attacks/CIFAR-10/ResNet18/PGD
===> begin calculating mean and variance for ResNet18
Traceback (most recent call last):
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 62, in <module>
    main()
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 59, in main
    testTimeAdaptation(student, dataset_dir, model_name, attack)
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 41, in testTimeAdaptation
    tta_model.obtain_origin_stat(clean_data_loader)
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/rotta.py", line 119, in obtain_origin_stat
    for images, _ in train_loader:
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torchvision/datasets/folder.py", line 247, in __getitem__
    sample = self.transform(sample)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
          ^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torchvision/transforms/transforms.py", line 354, in forward
    return F.resize(img, self.size, self.interpolation, self.max_size, self.antialias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torchvision/transforms/functional.py", line 468, in resize
    return F_pil.resize(img, size=output_size, interpolation=pil_interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torchvision/transforms/_functional_pil.py", line 250, in resize
    return img.resize(tuple(size[::-1]), interpolation)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/PIL/Image.py", line 2200, in resize
    return self._new(self.im.resize(size, resample, box))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
