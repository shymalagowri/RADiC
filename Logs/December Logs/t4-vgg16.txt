torch.Size([2, 10])
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.5]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.672]  3%|▎         | 2/63 [00:00<00:04, 13.69it/s, accuracy=0.672]  3%|▎         | 2/63 [00:00<00:04, 13.69it/s, accuracy=0.677]  3%|▎         | 2/63 [00:00<00:04, 13.69it/s, accuracy=0.664]  6%|▋         | 4/63 [00:00<00:05, 10.95it/s, accuracy=0.664]  6%|▋         | 4/63 [00:00<00:05, 10.95it/s, accuracy=0.662]  6%|▋         | 4/63 [00:00<00:05, 10.95it/s, accuracy=0.672] 10%|▉         | 6/63 [00:00<00:04, 12.36it/s, accuracy=0.672] 10%|▉         | 6/63 [00:00<00:04, 12.36it/s, accuracy=0.679] 10%|▉         | 6/63 [00:00<00:04, 12.36it/s, accuracy=0.691] 13%|█▎        | 8/63 [00:00<00:04, 12.58it/s, accuracy=0.691] 13%|█▎        | 8/63 [00:00<00:04, 12.58it/s, accuracy=0.708] 13%|█▎        | 8/63 [00:00<00:04, 12.58it/s, accuracy=0.703] 16%|█▌        | 10/63 [00:00<00:03, 13.57it/s, accuracy=0.703] 16%|█▌        | 10/63 [00:00<00:03, 13.57it/s, accuracy=0.707] 16%|█▌        | 10/63 [00:00<00:03, 13.57it/s, accuracy=0.716] 19%|█▉        | 12/63 [00:00<00:03, 14.24it/s, accuracy=0.716] 19%|█▉        | 12/63 [00:00<00:03, 14.24it/s, accuracy=0.7]   19%|█▉        | 12/63 [00:01<00:03, 14.24it/s, accuracy=0.685] 22%|██▏       | 14/63 [00:01<00:03, 14.47it/s, accuracy=0.685] 22%|██▏       | 14/63 [00:01<00:03, 14.47it/s, accuracy=0.673] 22%|██▏       | 14/63 [00:01<00:03, 14.47it/s, accuracy=0.666] 25%|██▌       | 16/63 [00:01<00:03, 14.20it/s, accuracy=0.666] 25%|██▌       | 16/63 [00:01<00:03, 14.20it/s, accuracy=0.66]  25%|██▌       | 16/63 [00:01<00:03, 14.20it/s, accuracy=0.648] 29%|██▊       | 18/63 [00:01<00:03, 12.09it/s, accuracy=0.648] 29%|██▊       | 18/63 [00:01<00:03, 12.09it/s, accuracy=0.645] 29%|██▊       | 18/63 [00:01<00:03, 12.09it/s, accuracy=0.639] 32%|███▏      | 20/63 [00:01<00:03, 13.05it/s, accuracy=0.639] 32%|███▏      | 20/63 [00:01<00:03, 13.05it/s, accuracy=0.637] 32%|███▏      | 20/63 [00:01<00:03, 13.05it/s, accuracy=0.643] 35%|███▍      | 22/63 [00:01<00:02, 13.73it/s, accuracy=0.643] 35%|███▍      | 22/63 [00:01<00:02, 13.73it/s, accuracy=0.639] 35%|███▍      | 22/63 [00:01<00:02, 13.73it/s, accuracy=0.634] 38%|███▊      | 24/63 [00:01<00:02, 14.21it/s, accuracy=0.634] 38%|███▊      | 24/63 [00:01<00:02, 14.21it/s, accuracy=0.636] 38%|███▊      | 24/63 [00:01<00:02, 14.21it/s, accuracy=0.624] 41%|████▏     | 26/63 [00:01<00:02, 14.52it/s, accuracy=0.624] 41%|████▏     | 26/63 [00:01<00:02, 14.52it/s, accuracy=0.619] 41%|████▏     | 26/63 [00:02<00:02, 14.52it/s, accuracy=0.612] 44%|████▍     | 28/63 [00:02<00:02, 14.75it/s, accuracy=0.612] 44%|████▍     | 28/63 [00:02<00:02, 14.75it/s, accuracy=0.601] 44%|████▍     | 28/63 [00:02<00:02, 14.75it/s, accuracy=0.596] 48%|████▊     | 30/63 [00:02<00:02, 14.90it/s, accuracy=0.596] 48%|████▊     | 30/63 [00:02<00:02, 14.90it/s, accuracy=0.589] 48%|████▊     | 30/63 [00:02<00:02, 14.90it/s, accuracy=0.583] 51%|█████     | 32/63 [00:02<00:02, 15.06it/s, accuracy=0.583] 51%|█████     | 32/63 [00:02<00:02, 15.06it/s, accuracy=0.58]  51%|█████     | 32/63 [00:02<00:02, 15.06it/s, accuracy=0.58] 54%|█████▍    | 34/63 [00:02<00:02, 14.09it/s, accuracy=0.58] 54%|█████▍    | 34/63 [00:02<00:02, 14.09it/s, accuracy=0.578] 54%|█████▍    | 34/63 [00:02<00:02, 14.09it/s, accuracy=0.575] 57%|█████▋    | 36/63 [00:02<00:01, 14.48it/s, accuracy=0.575] 57%|█████▋    | 36/63 [00:02<00:01, 14.48it/s, accuracy=0.573] 57%|█████▋    | 36/63 [00:02<00:01, 14.48it/s, accuracy=0.572] 60%|██████    | 38/63 [00:02<00:01, 14.74it/s, accuracy=0.572] 60%|██████    | 38/63 [00:02<00:01, 14.74it/s, accuracy=0.575] 60%|██████    | 38/63 [00:02<00:01, 14.74it/s, accuracy=0.58]  63%|██████▎   | 40/63 [00:02<00:01, 14.99it/s, accuracy=0.58] 63%|██████▎   | 40/63 [00:02<00:01, 14.99it/s, accuracy=0.587] 63%|██████▎   | 40/63 [00:02<00:01, 14.99it/s, accuracy=0.592] 67%|██████▋   | 42/63 [00:02<00:01, 15.02it/s, accuracy=0.592] 67%|██████▋   | 42/63 [00:03<00:01, 15.02it/s, accuracy=0.598] 67%|██████▋   | 42/63 [00:03<00:01, 15.02it/s, accuracy=0.601] 70%|██████▉   | 44/63 [00:03<00:01, 15.20it/s, accuracy=0.601] 70%|██████▉   | 44/63 [00:03<00:01, 15.20it/s, accuracy=0.603] 70%|██████▉   | 44/63 [00:03<00:01, 15.20it/s, accuracy=0.605] 73%|███████▎  | 46/63 [00:03<00:01, 15.38it/s, accuracy=0.605] 73%|███████▎  | 46/63 [00:03<00:01, 15.38it/s, accuracy=0.608] 73%|███████▎  | 46/63 [00:03<00:01, 15.38it/s, accuracy=0.608] 76%|███████▌  | 48/63 [00:03<00:00, 15.40it/s, accuracy=0.608] 76%|███████▌  | 48/63 [00:03<00:00, 15.40it/s, accuracy=0.608] 76%|███████▌  | 48/63 [00:03<00:00, 15.40it/s, accuracy=0.604] 79%|███████▉  | 50/63 [00:03<00:00, 15.21it/s, accuracy=0.604] 79%|███████▉  | 50/63 [00:03<00:00, 15.21it/s, accuracy=0.608] 79%|███████▉  | 50/63 [00:03<00:00, 15.21it/s, accuracy=0.612] 83%|████████▎ | 52/63 [00:03<00:00, 15.18it/s, accuracy=0.612] 83%|████████▎ | 52/63 [00:03<00:00, 15.18it/s, accuracy=0.614] 83%|████████▎ | 52/63 [00:03<00:00, 15.18it/s, accuracy=0.619] 86%|████████▌ | 54/63 [00:03<00:00, 15.10it/s, accuracy=0.619] 86%|████████▌ | 54/63 [00:03<00:00, 15.10it/s, accuracy=0.624] 86%|████████▌ | 54/63 [00:03<00:00, 15.10it/s, accuracy=0.628] 89%|████████▉ | 56/63 [00:03<00:00, 15.05it/s, accuracy=0.628] 89%|████████▉ | 56/63 [00:03<00:00, 15.05it/s, accuracy=0.628] 89%|████████▉ | 56/63 [00:04<00:00, 15.05it/s, accuracy=0.632] 92%|█████████▏| 58/63 [00:04<00:00, 14.83it/s, accuracy=0.632] 92%|█████████▏| 58/63 [00:04<00:00, 14.83it/s, accuracy=0.635] 92%|█████████▏| 58/63 [00:04<00:00, 14.83it/s, accuracy=0.639] 95%|█████████▌| 60/63 [00:04<00:00, 14.46it/s, accuracy=0.639] 95%|█████████▌| 60/63 [00:04<00:00, 14.46it/s, accuracy=0.64]  95%|█████████▌| 60/63 [00:04<00:00, 14.46it/s, accuracy=0.641] 98%|█████████▊| 62/63 [00:04<00:00, 14.45it/s, accuracy=0.641] 98%|█████████▊| 62/63 [00:04<00:00, 14.45it/s, accuracy=0.64] 100%|██████████| 63/63 [00:04<00:00, 14.47it/s, accuracy=0.64]
Final Accuracy : 0.6405
Average Loss: 0.05406129601597786
Confusion matrix and metrics saved for model: VGG16-T4
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.562]  2%|▏         | 1/63 [00:00<00:04, 13.59it/s, accuracy=0.562]
Traceback (most recent call last):
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 61, in <module>
    main()
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 58, in main
    testTimeAdaptation(student, dataset_dir, model_name, attack)
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/main.py", line 46, in testTimeAdaptation
    evaluate_tta(loader, tta_model, student, f'VGG16-T4', attack_type)
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/helper.py", line 112, in evaluate_tta
    output = tta_model(images)
             ^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/base_adapter.py", line 21, in forward
    outputs = self.forward_and_adapt(x, self.model, self.optimizer)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/rotta.py", line 39, in forward_and_adapt
    self.update_model(model, optimizer)
  File "/home/project/Documents/RoTTA-Enhancement/RoTTA/rotta.py", line 48, in update_model
    optimizer.zero_grad()
    ^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'zero_grad'
