torch.Size([1, 100])
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/313 [00:00<?, ?it/s]  0%|          | 0/313 [00:00<?, ?it/s, accuracy=0.156]  0%|          | 0/313 [00:00<?, ?it/s, accuracy=0.141]  1%|          | 2/313 [00:00<00:25, 12.23it/s, accuracy=0.141]  1%|          | 2/313 [00:00<00:25, 12.23it/s, accuracy=0.177]  1%|          | 2/313 [00:00<00:25, 12.23it/s, accuracy=0.219]  1%|▏         | 4/313 [00:00<00:25, 12.14it/s, accuracy=0.219]  1%|▏         | 4/313 [00:00<00:25, 12.14it/s, accuracy=0.237]  1%|▏         | 4/313 [00:00<00:25, 12.14it/s, accuracy=0.245]  2%|▏         | 6/313 [00:00<00:25, 12.24it/s, accuracy=0.245]  2%|▏         | 6/313 [00:00<00:25, 12.24it/s, accuracy=0.223]  2%|▏         | 6/313 [00:00<00:25, 12.24it/s, accuracy=0.203]  3%|▎         | 8/313 [00:00<00:25, 11.78it/s, accuracy=0.203]  3%|▎         | 8/313 [00:00<00:25, 11.78it/s, accuracy=0.188]  3%|▎         | 8/313 [00:00<00:25, 11.78it/s, accuracy=0.175]  3%|▎         | 10/313 [00:00<00:25, 11.77it/s, accuracy=0.175]  3%|▎         | 10/313 [00:00<00:25, 11.77it/s, accuracy=0.162]  3%|▎         | 10/313 [00:01<00:25, 11.77it/s, accuracy=0.151]  4%|▍         | 12/313 [00:01<00:25, 11.78it/s, accuracy=0.151]  4%|▍         | 12/313 [00:01<00:25, 11.78it/s, accuracy=0.147]  4%|▍         | 12/313 [00:01<00:25, 11.78it/s, accuracy=0.138]  4%|▍         | 14/313 [00:01<00:25, 11.78it/s, accuracy=0.138]  4%|▍         | 14/313 [00:01<00:25, 11.78it/s, accuracy=0.133]  4%|▍         | 14/313 [00:01<00:25, 11.78it/s, accuracy=0.127]  5%|▌         | 16/313 [00:01<00:25, 11.77it/s, accuracy=0.127]  5%|▌         | 16/313 [00:01<00:25, 11.77it/s, accuracy=0.121]  5%|▌         | 16/313 [00:01<00:25, 11.77it/s, accuracy=0.118]  6%|▌         | 18/313 [00:01<00:25, 11.66it/s, accuracy=0.118]  6%|▌         | 18/313 [00:01<00:25, 11.66it/s, accuracy=0.117]  6%|▌         | 18/313 [00:01<00:25, 11.66it/s, accuracy=0.116]  6%|▋         | 20/313 [00:01<00:25, 11.60it/s, accuracy=0.116]  6%|▋         | 20/313 [00:01<00:25, 11.60it/s, accuracy=0.124]  6%|▋         | 20/313 [00:01<00:25, 11.60it/s, accuracy=0.128]  7%|▋         | 22/313 [00:01<00:25, 11.41it/s, accuracy=0.128]  7%|▋         | 22/313 [00:01<00:25, 11.41it/s, accuracy=0.128]  7%|▋         | 22/313 [00:02<00:25, 11.41it/s, accuracy=0.128]  8%|▊         | 24/313 [00:02<00:25, 11.42it/s, accuracy=0.128]  8%|▊         | 24/313 [00:02<00:25, 11.42it/s, accuracy=0.13]   8%|▊         | 24/313 [00:02<00:25, 11.42it/s, accuracy=0.133]  8%|▊         | 26/313 [00:02<00:25, 11.43it/s, accuracy=0.133]  8%|▊         | 26/313 [00:02<00:25, 11.43it/s, accuracy=0.131]  8%|▊         | 26/313 [00:02<00:25, 11.43it/s, accuracy=0.137]  9%|▉         | 28/313 [00:02<00:26, 10.94it/s, accuracy=0.137]  9%|▉         | 28/313 [00:02<00:26, 10.94it/s, accuracy=0.148]  9%|▉         | 28/313 [00:02<00:26, 10.94it/s, accuracy=0.154] 10%|▉         | 30/313 [00:02<00:26, 10.61it/s, accuracy=0.154] 10%|▉         | 30/313 [00:02<00:26, 10.61it/s, accuracy=0.162] 10%|▉         | 30/313 [00:02<00:26, 10.61it/s, accuracy=0.166] 10%|█         | 32/313 [00:02<00:26, 10.52it/s, accuracy=0.166] 10%|█         | 32/313 [00:02<00:26, 10.52it/s, accuracy=0.165] 10%|█         | 32/313 [00:03<00:26, 10.52it/s, accuracy=0.162] 11%|█         | 34/313 [00:03<00:26, 10.68it/s, accuracy=0.162] 11%|█         | 34/313 [00:03<00:26, 10.68it/s, accuracy=0.159] 11%|█         | 34/313 [00:03<00:26, 10.68it/s, accuracy=0.155] 12%|█▏        | 36/313 [00:03<00:25, 10.74it/s, accuracy=0.155] 12%|█▏        | 36/313 [00:03<00:25, 10.74it/s, accuracy=0.151] 12%|█▏        | 36/313 [00:03<00:25, 10.74it/s, accuracy=0.148] 12%|█▏        | 38/313 [00:03<00:26, 10.34it/s, accuracy=0.148] 12%|█▏        | 38/313 [00:03<00:26, 10.34it/s, accuracy=0.145] 12%|█▏        | 38/313 [00:03<00:26, 10.34it/s, accuracy=0.145] 13%|█▎        | 40/313 [00:03<00:25, 10.68it/s, accuracy=0.145] 13%|█▎        | 40/313 [00:03<00:25, 10.68it/s, accuracy=0.146] 13%|█▎        | 40/313 [00:03<00:25, 10.68it/s, accuracy=0.15]  13%|█▎        | 42/313 [00:03<00:24, 10.97it/s, accuracy=0.15] 13%|█▎        | 42/313 [00:03<00:24, 10.97it/s, accuracy=0.149] 13%|█▎        | 42/313 [00:03<00:24, 10.97it/s, accuracy=0.153] 14%|█▍        | 44/313 [00:03<00:24, 11.17it/s, accuracy=0.153] 14%|█▍        | 44/313 [00:03<00:24, 11.17it/s, accuracy=0.153] 14%|█▍        | 44/313 [00:04<00:24, 11.17it/s, accuracy=0.152] 15%|█▍        | 46/313 [00:04<00:23, 11.28it/s, accuracy=0.152] 15%|█▍        | 46/313 [00:04<00:23, 11.28it/s, accuracy=0.152] 15%|█▍        | 46/313 [00:04<00:23, 11.28it/s, accuracy=0.152] 15%|█▌        | 48/313 [00:04<00:23, 11.35it/s, accuracy=0.152] 15%|█▌        | 48/313 [00:04<00:23, 11.35it/s, accuracy=0.15]  15%|█▌        | 48/313 [00:04<00:23, 11.35it/s, accuracy=0.149] 16%|█▌        | 50/313 [00:04<00:23, 11.37it/s, accuracy=0.149] 16%|█▌        | 50/313 [00:04<00:23, 11.37it/s, accuracy=0.148] 16%|█▌        | 50/313 [00:04<00:23, 11.37it/s, accuracy=0.147] 17%|█▋        | 52/313 [00:04<00:22, 11.43it/s, accuracy=0.147] 17%|█▋        | 52/313 [00:04<00:22, 11.43it/s, accuracy=0.148] 17%|█▋        | 52/313 [00:04<00:22, 11.43it/s, accuracy=0.15]  17%|█▋        | 54/313 [00:04<00:22, 11.40it/s, accuracy=0.15] 17%|█▋        | 54/313 [00:04<00:22, 11.40it/s, accuracy=0.149] 17%|█▋        | 54/313 [00:04<00:22, 11.40it/s, accuracy=0.15]  18%|█▊        | 56/313 [00:04<00:22, 11.39it/s, accuracy=0.15] 18%|█▊        | 56/313 [00:05<00:22, 11.39it/s, accuracy=0.147] 18%|█▊        | 56/313 [00:05<00:22, 11.39it/s, accuracy=0.145] 19%|█▊        | 58/313 [00:05<00:22, 11.44it/s, accuracy=0.145] 19%|█▊        | 58/313 [00:05<00:22, 11.44it/s, accuracy=0.142] 19%|█▊        | 58/313 [00:05<00:22, 11.44it/s, accuracy=0.142] 19%|█▉        | 60/313 [00:05<00:22, 11.43it/s, accuracy=0.142] 19%|█▉        | 60/313 [00:05<00:22, 11.43it/s, accuracy=0.141] 19%|█▉        | 60/313 [00:05<00:22, 11.43it/s, accuracy=0.143] 20%|█▉        | 62/313 [00:05<00:21, 11.51it/s, accuracy=0.143] 20%|█▉        | 62/313 [00:05<00:21, 11.51it/s, accuracy=0.145] 20%|█▉        | 62/313 [00:05<00:21, 11.51it/s, accuracy=0.148] 20%|██        | 64/313 [00:05<00:21, 11.58it/s, accuracy=0.148] 20%|██        | 64/313 [00:05<00:21, 11.58it/s, accuracy=0.152] 20%|██        | 64/313 [00:05<00:21, 11.58it/s, accuracy=0.156] 21%|██        | 66/313 [00:05<00:21, 11.65it/s, accuracy=0.156] 21%|██        | 66/313 [00:05<00:21, 11.65it/s, accuracy=0.157] 21%|██        | 66/313 [00:05<00:21, 11.65it/s, accuracy=0.162] 22%|██▏       | 68/313 [00:05<00:21, 11.62it/s, accuracy=0.162] 22%|██▏       | 68/313 [00:06<00:21, 11.62it/s, accuracy=0.165] 22%|██▏       | 68/313 [00:06<00:21, 11.62it/s, accuracy=0.165] 22%|██▏       | 70/313 [00:06<00:22, 11.05it/s, accuracy=0.165] 22%|██▏       | 70/313 [00:06<00:22, 11.05it/s, accuracy=0.166] 22%|██▏       | 70/313 [00:06<00:22, 11.05it/s, accuracy=0.166] 23%|██▎       | 72/313 [00:06<00:22, 10.77it/s, accuracy=0.166] 23%|██▎       | 72/313 [00:06<00:22, 10.77it/s, accuracy=0.167] 23%|██▎       | 72/313 [00:06<00:22, 10.77it/s, accuracy=0.167] 24%|██▎       | 74/313 [00:06<00:23, 10.21it/s, accuracy=0.167] 24%|██▎       | 74/313 [00:06<00:23, 10.21it/s, accuracy=0.17]  24%|██▎       | 74/313 [00:06<00:23, 10.21it/s, accuracy=0.172] 24%|██▍       | 76/313 [00:06<00:22, 10.59it/s, accuracy=0.172] 24%|██▍       | 76/313 [00:06<00:22, 10.59it/s, accuracy=0.174] 24%|██▍       | 76/313 [00:06<00:22, 10.59it/s, accuracy=0.178] 25%|██▍       | 78/313 [00:06<00:21, 10.77it/s, accuracy=0.178] 25%|██▍       | 78/313 [00:07<00:21, 10.77it/s, accuracy=0.176] 25%|██▍       | 78/313 [00:07<00:21, 10.77it/s, accuracy=0.175] 26%|██▌       | 80/313 [00:07<00:21, 10.94it/s, accuracy=0.175] 26%|██▌       | 80/313 [00:07<00:21, 10.94it/s, accuracy=0.174] 26%|██▌       | 80/313 [00:07<00:21, 10.94it/s, accuracy=0.173] 26%|██▌       | 82/313 [00:07<00:20, 11.10it/s, accuracy=0.173] 26%|██▌       | 82/313 [00:07<00:20, 11.10it/s, accuracy=0.171] 26%|██▌       | 82/313 [00:07<00:20, 11.10it/s, accuracy=0.169] 27%|██▋       | 84/313 [00:07<00:20, 11.21it/s, accuracy=0.169] 27%|██▋       | 84/313 [00:07<00:20, 11.21it/s, accuracy=0.168] 27%|██▋       | 84/313 [00:07<00:20, 11.21it/s, accuracy=0.168] 27%|██▋       | 86/313 [00:07<00:19, 11.37it/s, accuracy=0.168] 27%|██▋       | 86/313 [00:07<00:19, 11.37it/s, accuracy=0.167] 27%|██▋       | 86/313 [00:07<00:19, 11.37it/s, accuracy=0.169] 28%|██▊       | 88/313 [00:07<00:19, 11.42it/s, accuracy=0.169] 28%|██▊       | 88/313 [00:07<00:19, 11.42it/s, accuracy=0.17]  28%|██▊       | 88/313 [00:08<00:19, 11.42it/s, accuracy=0.173] 29%|██▉       | 90/313 [00:08<00:19, 11.42it/s, accuracy=0.173] 29%|██▉       | 90/313 [00:08<00:19, 11.42it/s, accuracy=0.173] 29%|██▉       | 90/313 [00:08<00:19, 11.42it/s, accuracy=0.173] 29%|██▉       | 92/313 [00:08<00:19, 11.49it/s, accuracy=0.173] 29%|██▉       | 92/313 [00:08<00:19, 11.49it/s, accuracy=0.172] 29%|██▉       | 92/313 [00:08<00:19, 11.49it/s, accuracy=0.171] 30%|███       | 94/313 [00:08<00:19, 11.50it/s, accuracy=0.171] 30%|███       | 94/313 [00:08<00:19, 11.50it/s, accuracy=0.17]  30%|███       | 94/313 [00:08<00:19, 11.50it/s, accuracy=0.168] 31%|███       | 96/313 [00:08<00:18, 11.53it/s, accuracy=0.168] 31%|███       | 96/313 [00:08<00:18, 11.53it/s, accuracy=0.169] 31%|███       | 96/313 [00:08<00:18, 11.53it/s, accuracy=0.168] 31%|███▏      | 98/313 [00:08<00:18, 11.58it/s, accuracy=0.168] 31%|███▏      | 98/313 [00:08<00:18, 11.58it/s, accuracy=0.167] 31%|███▏      | 98/313 [00:08<00:18, 11.58it/s, accuracy=0.166] 32%|███▏      | 100/313 [00:08<00:18, 11.60it/s, accuracy=0.166] 32%|███▏      | 100/313 [00:08<00:18, 11.60it/s, accuracy=0.165] 32%|███▏      | 100/313 [00:09<00:18, 11.60it/s, accuracy=0.165] 33%|███▎      | 102/313 [00:09<00:18, 11.63it/s, accuracy=0.165] 33%|███▎      | 102/313 [00:09<00:18, 11.63it/s, accuracy=0.167] 33%|███▎      | 102/313 [00:09<00:18, 11.63it/s, accuracy=0.167] 33%|███▎      | 104/313 [00:09<00:17, 11.64it/s, accuracy=0.167] 33%|███▎      | 104/313 [00:09<00:17, 11.64it/s, accuracy=0.168] 33%|███▎      | 104/313 [00:09<00:17, 11.64it/s, accuracy=0.168] 34%|███▍      | 106/313 [00:09<00:17, 11.58it/s, accuracy=0.168] 34%|███▍      | 106/313 [00:09<00:17, 11.58it/s, accuracy=0.167] 34%|███▍      | 106/313 [00:09<00:17, 11.58it/s, accuracy=0.167] 35%|███▍      | 108/313 [00:09<00:17, 11.58it/s, accuracy=0.167] 35%|███▍      | 108/313 [00:09<00:17, 11.58it/s, accuracy=0.166] 35%|███▍      | 108/313 [00:09<00:17, 11.58it/s, accuracy=0.165] 35%|███▌      | 110/313 [00:09<00:17, 11.51it/s, accuracy=0.165] 35%|███▌      | 110/313 [00:09<00:17, 11.51it/s, accuracy=0.166] 35%|███▌      | 110/313 [00:09<00:17, 11.51it/s, accuracy=0.165] 36%|███▌      | 112/313 [00:09<00:17, 11.51it/s, accuracy=0.165] 36%|███▌      | 112/313 [00:09<00:17, 11.51it/s, accuracy=0.165] 36%|███▌      | 112/313 [00:10<00:17, 11.51it/s, accuracy=0.165] 36%|███▋      | 114/313 [00:10<00:17, 11.59it/s, accuracy=0.165] 36%|███▋      | 114/313 [00:10<00:17, 11.59it/s, accuracy=0.165] 36%|███▋      | 114/313 [00:10<00:17, 11.59it/s, accuracy=0.164] 37%|███▋      | 116/313 [00:10<00:16, 11.62it/s, accuracy=0.164] 37%|███▋      | 116/313 [00:10<00:16, 11.62it/s, accuracy=0.164] 37%|███▋      | 116/313 [00:10<00:16, 11.62it/s, accuracy=0.164] 38%|███▊      | 118/313 [00:10<00:16, 11.65it/s, accuracy=0.164] 38%|███▊      | 118/313 [00:10<00:16, 11.65it/s, accuracy=0.164] 38%|███▊      | 118/313 [00:10<00:16, 11.65it/s, accuracy=0.163] 38%|███▊      | 120/313 [00:10<00:16, 11.67it/s, accuracy=0.163] 38%|███▊      | 120/313 [00:10<00:16, 11.67it/s, accuracy=0.162] 38%|███▊      | 120/313 [00:10<00:16, 11.67it/s, accuracy=0.161] 39%|███▉      | 122/313 [00:10<00:16, 11.67it/s, accuracy=0.161] 39%|███▉      | 122/313 [00:10<00:16, 11.67it/s, accuracy=0.162] 39%|███▉      | 122/313 [00:10<00:16, 11.67it/s, accuracy=0.164] 40%|███▉      | 124/313 [00:10<00:16, 11.69it/s, accuracy=0.164] 40%|███▉      | 124/313 [00:10<00:16, 11.69it/s, accuracy=0.165] 40%|███▉      | 124/313 [00:11<00:16, 11.69it/s, accuracy=0.165] 40%|████      | 126/313 [00:11<00:16, 11.66it/s, accuracy=0.165] 40%|████      | 126/313 [00:11<00:16, 11.66it/s, accuracy=0.164] 40%|████      | 126/313 [00:11<00:16, 11.66it/s, accuracy=0.164] 41%|████      | 128/313 [00:11<00:15, 11.64it/s, accuracy=0.164] 41%|████      | 128/313 [00:11<00:15, 11.64it/s, accuracy=0.166] 41%|████      | 128/313 [00:11<00:15, 11.64it/s, accuracy=0.169] 42%|████▏     | 130/313 [00:11<00:15, 11.67it/s, accuracy=0.169] 42%|████▏     | 130/313 [00:11<00:15, 11.67it/s, accuracy=0.17]  42%|████▏     | 130/313 [00:11<00:15, 11.67it/s, accuracy=0.17] 42%|████▏     | 132/313 [00:11<00:15, 11.71it/s, accuracy=0.17] 42%|████▏     | 132/313 [00:11<00:15, 11.71it/s, accuracy=0.169] 42%|████▏     | 132/313 [00:11<00:15, 11.71it/s, accuracy=0.168] 43%|████▎     | 134/313 [00:11<00:15, 11.73it/s, accuracy=0.168] 43%|████▎     | 134/313 [00:11<00:15, 11.73it/s, accuracy=0.168] 43%|████▎     | 134/313 [00:11<00:15, 11.73it/s, accuracy=0.167] 43%|████▎     | 136/313 [00:11<00:15, 11.73it/s, accuracy=0.167] 43%|████▎     | 136/313 [00:12<00:15, 11.73it/s, accuracy=0.168] 43%|████▎     | 136/313 [00:12<00:15, 11.73it/s, accuracy=0.167] 44%|████▍     | 138/313 [00:12<00:15, 11.30it/s, accuracy=0.167] 44%|████▍     | 138/313 [00:12<00:15, 11.30it/s, accuracy=0.166] 44%|████▍     | 138/313 [00:12<00:15, 11.30it/s, accuracy=0.165] 45%|████▍     | 140/313 [00:12<00:15, 11.47it/s, accuracy=0.165] 45%|████▍     | 140/313 [00:12<00:15, 11.47it/s, accuracy=0.164] 45%|████▍     | 140/313 [00:12<00:15, 11.47it/s, accuracy=0.163] 45%|████▌     | 142/313 [00:12<00:14, 11.52it/s, accuracy=0.163] 45%|████▌     | 142/313 [00:12<00:14, 11.52it/s, accuracy=0.161] 45%|████▌     | 142/313 [00:12<00:14, 11.52it/s, accuracy=0.161] 46%|████▌     | 144/313 [00:12<00:14, 11.59it/s, accuracy=0.161] 46%|████▌     | 144/313 [00:12<00:14, 11.59it/s, accuracy=0.16]  46%|████▌     | 144/313 [00:12<00:14, 11.59it/s, accuracy=0.161] 47%|████▋     | 146/313 [00:12<00:14, 11.64it/s, accuracy=0.161] 47%|████▋     | 146/313 [00:12<00:14, 11.64it/s, accuracy=0.162] 47%|████▋     | 146/313 [00:13<00:14, 11.64it/s, accuracy=0.162] 47%|████▋     | 148/313 [00:13<00:14, 11.67it/s, accuracy=0.162] 47%|████▋     | 148/313 [00:13<00:14, 11.67it/s, accuracy=0.163] 47%|████▋     | 148/313 [00:13<00:14, 11.67it/s, accuracy=0.163] 48%|████▊     | 150/313 [00:13<00:13, 11.69it/s, accuracy=0.163] 48%|████▊     | 150/313 [00:13<00:13, 11.69it/s, accuracy=0.163] 48%|████▊     | 150/313 [00:13<00:13, 11.69it/s, accuracy=0.164] 49%|████▊     | 152/313 [00:13<00:13, 11.71it/s, accuracy=0.164] 49%|████▊     | 152/313 [00:13<00:13, 11.71it/s, accuracy=0.166] 49%|████▊     | 152/313 [00:13<00:13, 11.71it/s, accuracy=0.167] 49%|████▉     | 154/313 [00:13<00:13, 11.71it/s, accuracy=0.167] 49%|████▉     | 154/313 [00:13<00:13, 11.71it/s, accuracy=0.168] 49%|████▉     | 154/313 [00:13<00:13, 11.71it/s, accuracy=0.169] 50%|████▉     | 156/313 [00:13<00:13, 11.73it/s, accuracy=0.169] 50%|████▉     | 156/313 [00:13<00:13, 11.73it/s, accuracy=0.169] 50%|████▉     | 156/313 [00:13<00:13, 11.73it/s, accuracy=0.168] 50%|█████     | 158/313 [00:13<00:13, 11.72it/s, accuracy=0.168] 50%|█████     | 158/313 [00:13<00:13, 11.72it/s, accuracy=0.168] 50%|█████     | 158/313 [00:14<00:13, 11.72it/s, accuracy=0.167] 51%|█████     | 160/313 [00:14<00:13, 11.72it/s, accuracy=0.167] 51%|█████     | 160/313 [00:14<00:13, 11.72it/s, accuracy=0.167] 51%|█████     | 160/313 [00:14<00:13, 11.72it/s, accuracy=0.166] 52%|█████▏    | 162/313 [00:14<00:12, 11.72it/s, accuracy=0.166] 52%|█████▏    | 162/313 [00:14<00:12, 11.72it/s, accuracy=0.166] 52%|█████▏    | 162/313 [00:14<00:12, 11.72it/s, accuracy=0.166] 52%|█████▏    | 164/313 [00:14<00:12, 11.73it/s, accuracy=0.166] 52%|█████▏    | 164/313 [00:14<00:12, 11.73it/s, accuracy=0.167] 52%|█████▏    | 164/313 [00:14<00:12, 11.73it/s, accuracy=0.169] 53%|█████▎    | 166/313 [00:14<00:12, 11.75it/s, accuracy=0.169] 53%|█████▎    | 166/313 [00:14<00:12, 11.75it/s, accuracy=0.169] 53%|█████▎    | 166/313 [00:14<00:12, 11.75it/s, accuracy=0.169] 54%|█████▎    | 168/313 [00:14<00:12, 11.73it/s, accuracy=0.169] 54%|█████▎    | 168/313 [00:14<00:12, 11.73it/s, accuracy=0.17]  54%|█████▎    | 168/313 [00:14<00:12, 11.73it/s, accuracy=0.169] 54%|█████▍    | 170/313 [00:14<00:12, 11.74it/s, accuracy=0.169] 54%|█████▍    | 170/313 [00:14<00:12, 11.74it/s, accuracy=0.169] 54%|█████▍    | 170/313 [00:15<00:12, 11.74it/s, accuracy=0.169] 55%|█████▍    | 172/313 [00:15<00:12, 11.74it/s, accuracy=0.169] 55%|█████▍    | 172/313 [00:15<00:12, 11.74it/s, accuracy=0.168] 55%|█████▍    | 172/313 [00:15<00:12, 11.74it/s, accuracy=0.167] 56%|█████▌    | 174/313 [00:15<00:11, 11.76it/s, accuracy=0.167] 56%|█████▌    | 174/313 [00:15<00:11, 11.76it/s, accuracy=0.167] 56%|█████▌    | 174/313 [00:15<00:11, 11.76it/s, accuracy=0.167] 56%|█████▌    | 176/313 [00:15<00:11, 11.73it/s, accuracy=0.167] 56%|█████▌    | 176/313 [00:15<00:11, 11.73it/s, accuracy=0.168] 56%|█████▌    | 176/313 [00:15<00:11, 11.73it/s, accuracy=0.169] 57%|█████▋    | 178/313 [00:15<00:11, 11.74it/s, accuracy=0.169] 57%|█████▋    | 178/313 [00:15<00:11, 11.74it/s, accuracy=0.169] 57%|█████▋    | 178/313 [00:15<00:11, 11.74it/s, accuracy=0.168] 58%|█████▊    | 180/313 [00:15<00:11, 11.76it/s, accuracy=0.168] 58%|█████▊    | 180/313 [00:15<00:11, 11.76it/s, accuracy=0.169] 58%|█████▊    | 180/313 [00:15<00:11, 11.76it/s, accuracy=0.169] 58%|█████▊    | 182/313 [00:15<00:11, 11.74it/s, accuracy=0.169] 58%|█████▊    | 182/313 [00:15<00:11, 11.74it/s, accuracy=0.17]  58%|█████▊    | 182/313 [00:16<00:11, 11.74it/s, accuracy=0.17] 59%|█████▉    | 184/313 [00:16<00:10, 11.74it/s, accuracy=0.17] 59%|█████▉    | 184/313 [00:16<00:10, 11.74it/s, accuracy=0.17] 59%|█████▉    | 184/313 [00:16<00:10, 11.74it/s, accuracy=0.17] 59%|█████▉    | 186/313 [00:16<00:10, 11.72it/s, accuracy=0.17] 59%|█████▉    | 186/313 [00:16<00:10, 11.72it/s, accuracy=0.169] 59%|█████▉    | 186/313 [00:16<00:10, 11.72it/s, accuracy=0.17]  60%|██████    | 188/313 [00:16<00:10, 11.71it/s, accuracy=0.17] 60%|██████    | 188/313 [00:16<00:10, 11.71it/s, accuracy=0.173] 60%|██████    | 188/313 [00:16<00:10, 11.71it/s, accuracy=0.174] 61%|██████    | 190/313 [00:16<00:10, 11.70it/s, accuracy=0.174] 61%|██████    | 190/313 [00:16<00:10, 11.70it/s, accuracy=0.175] 61%|██████    | 190/313 [00:16<00:10, 11.70it/s, accuracy=0.175] 61%|██████▏   | 192/313 [00:16<00:10, 11.71it/s, accuracy=0.175] 61%|██████▏   | 192/313 [00:16<00:10, 11.71it/s, accuracy=0.176] 61%|██████▏   | 192/313 [00:16<00:10, 11.71it/s, accuracy=0.177] 62%|██████▏   | 194/313 [00:16<00:10, 11.74it/s, accuracy=0.177] 62%|██████▏   | 194/313 [00:16<00:10, 11.74it/s, accuracy=0.177] 62%|██████▏   | 194/313 [00:17<00:10, 11.74it/s, accuracy=0.177] 63%|██████▎   | 196/313 [00:17<00:09, 11.77it/s, accuracy=0.177] 63%|██████▎   | 196/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 63%|██████▎   | 196/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 63%|██████▎   | 198/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 63%|██████▎   | 198/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 63%|██████▎   | 198/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 64%|██████▍   | 200/313 [00:17<00:09, 11.77it/s, accuracy=0.178] 64%|██████▍   | 200/313 [00:17<00:09, 11.77it/s, accuracy=0.177] 64%|██████▍   | 200/313 [00:17<00:09, 11.77it/s, accuracy=0.176] 65%|██████▍   | 202/313 [00:17<00:09, 11.79it/s, accuracy=0.176] 65%|██████▍   | 202/313 [00:17<00:09, 11.79it/s, accuracy=0.175] 65%|██████▍   | 202/313 [00:17<00:09, 11.79it/s, accuracy=0.175] 65%|██████▌   | 204/313 [00:17<00:09, 11.78it/s, accuracy=0.175] 65%|██████▌   | 204/313 [00:17<00:09, 11.78it/s, accuracy=0.174] 65%|██████▌   | 204/313 [00:17<00:09, 11.78it/s, accuracy=0.174] 66%|██████▌   | 206/313 [00:17<00:09, 11.79it/s, accuracy=0.174] 66%|██████▌   | 206/313 [00:17<00:09, 11.79it/s, accuracy=0.173] 66%|██████▌   | 206/313 [00:18<00:09, 11.79it/s, accuracy=0.173] 66%|██████▋   | 208/313 [00:18<00:08, 11.80it/s, accuracy=0.173] 66%|██████▋   | 208/313 [00:18<00:08, 11.80it/s, accuracy=0.173] 66%|██████▋   | 208/313 [00:18<00:08, 11.80it/s, accuracy=0.172] 67%|██████▋   | 210/313 [00:18<00:08, 11.78it/s, accuracy=0.172] 67%|██████▋   | 210/313 [00:18<00:08, 11.78it/s, accuracy=0.172] 67%|██████▋   | 210/313 [00:18<00:08, 11.78it/s, accuracy=0.171] 68%|██████▊   | 212/313 [00:18<00:08, 11.79it/s, accuracy=0.171] 68%|██████▊   | 212/313 [00:18<00:08, 11.79it/s, accuracy=0.171] 68%|██████▊   | 212/313 [00:18<00:08, 11.79it/s, accuracy=0.172] 68%|██████▊   | 214/313 [00:18<00:08, 11.78it/s, accuracy=0.172] 68%|██████▊   | 214/313 [00:18<00:08, 11.78it/s, accuracy=0.173] 68%|██████▊   | 214/313 [00:18<00:08, 11.78it/s, accuracy=0.173] 69%|██████▉   | 216/313 [00:18<00:08, 11.79it/s, accuracy=0.173] 69%|██████▉   | 216/313 [00:18<00:08, 11.79it/s, accuracy=0.174] 69%|██████▉   | 216/313 [00:18<00:08, 11.79it/s, accuracy=0.174] 70%|██████▉   | 218/313 [00:18<00:08, 11.63it/s, accuracy=0.174] 70%|██████▉   | 218/313 [00:19<00:08, 11.63it/s, accuracy=0.176] 70%|██████▉   | 218/313 [00:19<00:08, 11.63it/s, accuracy=0.176] 70%|███████   | 220/313 [00:19<00:07, 11.65it/s, accuracy=0.176] 70%|███████   | 220/313 [00:19<00:07, 11.65it/s, accuracy=0.177] 70%|███████   | 220/313 [00:19<00:07, 11.65it/s, accuracy=0.178] 71%|███████   | 222/313 [00:19<00:07, 11.70it/s, accuracy=0.178] 71%|███████   | 222/313 [00:19<00:07, 11.70it/s, accuracy=0.18]  71%|███████   | 222/313 [00:19<00:07, 11.70it/s, accuracy=0.181] 72%|███████▏  | 224/313 [00:19<00:07, 11.43it/s, accuracy=0.181] 72%|███████▏  | 224/313 [00:19<00:07, 11.43it/s, accuracy=0.183] 72%|███████▏  | 224/313 [00:19<00:07, 11.43it/s, accuracy=0.183] 72%|███████▏  | 226/313 [00:19<00:07, 11.55it/s, accuracy=0.183] 72%|███████▏  | 226/313 [00:19<00:07, 11.55it/s, accuracy=0.182] 72%|███████▏  | 226/313 [00:19<00:07, 11.55it/s, accuracy=0.182] 73%|███████▎  | 228/313 [00:19<00:07, 11.60it/s, accuracy=0.182] 73%|███████▎  | 228/313 [00:19<00:07, 11.60it/s, accuracy=0.182] 73%|███████▎  | 228/313 [00:19<00:07, 11.60it/s, accuracy=0.183] 73%|███████▎  | 230/313 [00:19<00:07, 11.65it/s, accuracy=0.183] 73%|███████▎  | 230/313 [00:20<00:07, 11.65it/s, accuracy=0.184] 73%|███████▎  | 230/313 [00:20<00:07, 11.65it/s, accuracy=0.184] 74%|███████▍  | 232/313 [00:20<00:06, 11.66it/s, accuracy=0.184] 74%|███████▍  | 232/313 [00:20<00:06, 11.66it/s, accuracy=0.183] 74%|███████▍  | 232/313 [00:20<00:06, 11.66it/s, accuracy=0.183] 75%|███████▍  | 234/313 [00:20<00:06, 11.69it/s, accuracy=0.183] 75%|███████▍  | 234/313 [00:20<00:06, 11.69it/s, accuracy=0.183] 75%|███████▍  | 234/313 [00:20<00:06, 11.69it/s, accuracy=0.184] 75%|███████▌  | 236/313 [00:20<00:06, 11.70it/s, accuracy=0.184] 75%|███████▌  | 236/313 [00:20<00:06, 11.70it/s, accuracy=0.185] 75%|███████▌  | 236/313 [00:20<00:06, 11.70it/s, accuracy=0.185] 76%|███████▌  | 238/313 [00:20<00:06, 11.70it/s, accuracy=0.185] 76%|███████▌  | 238/313 [00:20<00:06, 11.70it/s, accuracy=0.187] 76%|███████▌  | 238/313 [00:20<00:06, 11.70it/s, accuracy=0.188] 77%|███████▋  | 240/313 [00:20<00:06, 11.72it/s, accuracy=0.188] 77%|███████▋  | 240/313 [00:20<00:06, 11.72it/s, accuracy=0.189] 77%|███████▋  | 240/313 [00:21<00:06, 11.72it/s, accuracy=0.188] 77%|███████▋  | 242/313 [00:21<00:06, 11.72it/s, accuracy=0.188] 77%|███████▋  | 242/313 [00:21<00:06, 11.72it/s, accuracy=0.188] 77%|███████▋  | 242/313 [00:21<00:06, 11.72it/s, accuracy=0.187] 78%|███████▊  | 244/313 [00:21<00:05, 11.72it/s, accuracy=0.187] 78%|███████▊  | 244/313 [00:21<00:05, 11.72it/s, accuracy=0.187] 78%|███████▊  | 244/313 [00:21<00:05, 11.72it/s, accuracy=0.186] 79%|███████▊  | 246/313 [00:21<00:05, 11.73it/s, accuracy=0.186] 79%|███████▊  | 246/313 [00:21<00:05, 11.73it/s, accuracy=0.186] 79%|███████▊  | 246/313 [00:21<00:05, 11.73it/s, accuracy=0.187] 79%|███████▉  | 248/313 [00:21<00:05, 11.73it/s, accuracy=0.187] 79%|███████▉  | 248/313 [00:21<00:05, 11.73it/s, accuracy=0.186] 79%|███████▉  | 248/313 [00:21<00:05, 11.73it/s, accuracy=0.186] 80%|███████▉  | 250/313 [00:21<00:05, 11.74it/s, accuracy=0.186] 80%|███████▉  | 250/313 [00:21<00:05, 11.74it/s, accuracy=0.186] 80%|███████▉  | 250/313 [00:21<00:05, 11.74it/s, accuracy=0.185] 81%|████████  | 252/313 [00:21<00:05, 11.74it/s, accuracy=0.185] 81%|████████  | 252/313 [00:21<00:05, 11.74it/s, accuracy=0.185] 81%|████████  | 252/313 [00:22<00:05, 11.74it/s, accuracy=0.184] 81%|████████  | 254/313 [00:22<00:05, 11.73it/s, accuracy=0.184] 81%|████████  | 254/313 [00:22<00:05, 11.73it/s, accuracy=0.184] 81%|████████  | 254/313 [00:22<00:05, 11.73it/s, accuracy=0.184] 82%|████████▏ | 256/313 [00:22<00:04, 11.75it/s, accuracy=0.184] 82%|████████▏ | 256/313 [00:22<00:04, 11.75it/s, accuracy=0.184] 82%|████████▏ | 256/313 [00:22<00:04, 11.75it/s, accuracy=0.186] 82%|████████▏ | 258/313 [00:22<00:04, 11.77it/s, accuracy=0.186] 82%|████████▏ | 258/313 [00:22<00:04, 11.77it/s, accuracy=0.188] 82%|████████▏ | 258/313 [00:22<00:04, 11.77it/s, accuracy=0.188] 83%|████████▎ | 260/313 [00:22<00:04, 11.74it/s, accuracy=0.188] 83%|████████▎ | 260/313 [00:22<00:04, 11.74it/s, accuracy=0.187] 83%|████████▎ | 260/313 [00:22<00:04, 11.74it/s, accuracy=0.187] 84%|████████▎ | 262/313 [00:22<00:04, 11.75it/s, accuracy=0.187] 84%|████████▎ | 262/313 [00:22<00:04, 11.75it/s, accuracy=0.187] 84%|████████▎ | 262/313 [00:22<00:04, 11.75it/s, accuracy=0.186] 84%|████████▍ | 264/313 [00:22<00:04, 11.76it/s, accuracy=0.186] 84%|████████▍ | 264/313 [00:22<00:04, 11.76it/s, accuracy=0.186] 84%|████████▍ | 264/313 [00:23<00:04, 11.76it/s, accuracy=0.185] 85%|████████▍ | 266/313 [00:23<00:04, 11.74it/s, accuracy=0.185] 85%|████████▍ | 266/313 [00:23<00:04, 11.74it/s, accuracy=0.185] 85%|████████▍ | 266/313 [00:23<00:04, 11.74it/s, accuracy=0.185] 86%|████████▌ | 268/313 [00:23<00:03, 11.75it/s, accuracy=0.185] 86%|████████▌ | 268/313 [00:23<00:03, 11.75it/s, accuracy=0.186] 86%|████████▌ | 268/313 [00:23<00:03, 11.75it/s, accuracy=0.186] 86%|████████▋ | 270/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 86%|████████▋ | 270/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 86%|████████▋ | 270/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 87%|████████▋ | 272/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 87%|████████▋ | 272/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 87%|████████▋ | 272/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 88%|████████▊ | 274/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 88%|████████▊ | 274/313 [00:23<00:03, 11.74it/s, accuracy=0.187] 88%|████████▊ | 274/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 88%|████████▊ | 276/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 88%|████████▊ | 276/313 [00:23<00:03, 11.74it/s, accuracy=0.186] 88%|████████▊ | 276/313 [00:24<00:03, 11.74it/s, accuracy=0.185] 89%|████████▉ | 278/313 [00:24<00:02, 11.74it/s, accuracy=0.185] 89%|████████▉ | 278/313 [00:24<00:02, 11.74it/s, accuracy=0.185] 89%|████████▉ | 278/313 [00:24<00:02, 11.74it/s, accuracy=0.185] 89%|████████▉ | 280/313 [00:24<00:02, 11.72it/s, accuracy=0.185] 89%|████████▉ | 280/313 [00:24<00:02, 11.72it/s, accuracy=0.185] 89%|████████▉ | 280/313 [00:24<00:02, 11.72it/s, accuracy=0.184] 90%|█████████ | 282/313 [00:24<00:02, 11.75it/s, accuracy=0.184] 90%|█████████ | 282/313 [00:24<00:02, 11.75it/s, accuracy=0.184] 90%|█████████ | 282/313 [00:24<00:02, 11.75it/s, accuracy=0.184] 91%|█████████ | 284/313 [00:24<00:02, 11.74it/s, accuracy=0.184] 91%|█████████ | 284/313 [00:24<00:02, 11.74it/s, accuracy=0.184] 91%|█████████ | 284/313 [00:24<00:02, 11.74it/s, accuracy=0.184] 91%|█████████▏| 286/313 [00:24<00:02, 11.75it/s, accuracy=0.184] 91%|█████████▏| 286/313 [00:24<00:02, 11.75it/s, accuracy=0.185] 91%|█████████▏| 286/313 [00:24<00:02, 11.75it/s, accuracy=0.184] 92%|█████████▏| 288/313 [00:24<00:02, 11.74it/s, accuracy=0.184] 92%|█████████▏| 288/313 [00:24<00:02, 11.74it/s, accuracy=0.184] 92%|█████████▏| 288/313 [00:25<00:02, 11.74it/s, accuracy=0.184] 93%|█████████▎| 290/313 [00:25<00:01, 11.75it/s, accuracy=0.184] 93%|█████████▎| 290/313 [00:25<00:01, 11.75it/s, accuracy=0.184] 93%|█████████▎| 290/313 [00:25<00:01, 11.75it/s, accuracy=0.184] 93%|█████████▎| 292/313 [00:25<00:01, 11.76it/s, accuracy=0.184] 93%|█████████▎| 292/313 [00:25<00:01, 11.76it/s, accuracy=0.183] 93%|█████████▎| 292/313 [00:25<00:01, 11.76it/s, accuracy=0.183] 94%|█████████▍| 294/313 [00:25<00:01, 11.76it/s, accuracy=0.183] 94%|█████████▍| 294/313 [00:25<00:01, 11.76it/s, accuracy=0.184] 94%|█████████▍| 294/313 [00:25<00:01, 11.76it/s, accuracy=0.185] 95%|█████████▍| 296/313 [00:25<00:01, 11.79it/s, accuracy=0.185] 95%|█████████▍| 296/313 [00:25<00:01, 11.79it/s, accuracy=0.186] 95%|█████████▍| 296/313 [00:25<00:01, 11.79it/s, accuracy=0.186] 95%|█████████▌| 298/313 [00:25<00:01, 11.78it/s, accuracy=0.186] 95%|█████████▌| 298/313 [00:25<00:01, 11.78it/s, accuracy=0.187] 95%|█████████▌| 298/313 [00:25<00:01, 11.78it/s, accuracy=0.187] 96%|█████████▌| 300/313 [00:25<00:01, 11.76it/s, accuracy=0.187] 96%|█████████▌| 300/313 [00:25<00:01, 11.76it/s, accuracy=0.187] 96%|█████████▌| 300/313 [00:26<00:01, 11.76it/s, accuracy=0.187] 96%|█████████▋| 302/313 [00:26<00:00, 11.79it/s, accuracy=0.187] 96%|█████████▋| 302/313 [00:26<00:00, 11.79it/s, accuracy=0.188] 96%|█████████▋| 302/313 [00:26<00:00, 11.79it/s, accuracy=0.188] 97%|█████████▋| 304/313 [00:26<00:00, 11.52it/s, accuracy=0.188] 97%|█████████▋| 304/313 [00:26<00:00, 11.52it/s, accuracy=0.188] 97%|█████████▋| 304/313 [00:26<00:00, 11.52it/s, accuracy=0.187] 98%|█████████▊| 306/313 [00:26<00:00, 11.57it/s, accuracy=0.187] 98%|█████████▊| 306/313 [00:26<00:00, 11.57it/s, accuracy=0.187] 98%|█████████▊| 306/313 [00:26<00:00, 11.57it/s, accuracy=0.187] 98%|█████████▊| 308/313 [00:26<00:00, 11.57it/s, accuracy=0.187] 98%|█████████▊| 308/313 [00:26<00:00, 11.57it/s, accuracy=0.186] 98%|█████████▊| 308/313 [00:26<00:00, 11.57it/s, accuracy=0.186] 99%|█████████▉| 310/313 [00:26<00:00, 11.55it/s, accuracy=0.186] 99%|█████████▉| 310/313 [00:26<00:00, 11.55it/s, accuracy=0.186] 99%|█████████▉| 310/313 [00:26<00:00, 11.55it/s, accuracy=0.186]100%|█████████▉| 312/313 [00:26<00:00, 11.61it/s, accuracy=0.186]100%|█████████▉| 312/313 [00:27<00:00, 11.61it/s, accuracy=0.186]100%|██████████| 313/313 [00:27<00:00, 11.58it/s, accuracy=0.186]
Final Accuracy : 0.1856
Average Loss: 0.31414159684181214
Confusion matrix and metrics saved for model: PRN18
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/313 [00:00<?, ?it/s]  0%|          | 0/313 [00:00<?, ?it/s, accuracy=0]  0%|          | 1/313 [00:00<00:24, 12.99it/s, accuracy=0]
Traceback (most recent call last):
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/main.py", line 60, in <module>
    main()
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/main.py", line 57, in main
    testTimeAdaptation(student, dataset_dir, model_name, attack)
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/main.py", line 45, in testTimeAdaptation
    evaluate_tta(loader, tta_model, student, model_name, attack_type)
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/modules/helper.py", line 109, in evaluate_tta
    output = tta_model(images)
             ^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/modules/base_adapter.py", line 21, in forward
    outputs = self.forward_and_adapt(x, self.model, self.optimizer)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/miniconda3/envs/tta/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/modules/defense.py", line 38, in forward_and_adapt
    self.update_model(model, optimizer)
  File "/home/project/Documents/RoTTA-Enhancement/RADiC/modules/defense.py", line 47, in update_model
    optimizer.zero_grad()
    ^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'zero_grad'
