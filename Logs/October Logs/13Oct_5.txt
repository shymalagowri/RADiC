../Attacks/CIFAR-10/ResNet18/FGSM
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0.0625]  2%|▏         | 1/63 [00:00<00:08,  7.37it/s, accuracy=0.0625]  2%|▏         | 1/63 [00:00<00:08,  7.37it/s, accuracy=0.0312]  3%|▎         | 2/63 [00:00<00:14,  4.29it/s, accuracy=0.0312]  3%|▎         | 2/63 [00:00<00:14,  4.29it/s, accuracy=0.0312]  5%|▍         | 3/63 [00:00<00:11,  5.10it/s, accuracy=0.0312]  5%|▍         | 3/63 [00:00<00:11,  5.10it/s, accuracy=0.0234]  6%|▋         | 4/63 [00:00<00:15,  3.90it/s, accuracy=0.0234]  6%|▋         | 4/63 [00:01<00:15,  3.90it/s, accuracy=0.075]   8%|▊         | 5/63 [00:01<00:12,  4.59it/s, accuracy=0.075]  8%|▊         | 5/63 [00:01<00:12,  4.59it/s, accuracy=0.0625] 10%|▉         | 6/63 [00:01<00:17,  3.32it/s, accuracy=0.0625] 10%|▉         | 6/63 [00:01<00:17,  3.32it/s, accuracy=0.0536] 11%|█         | 7/63 [00:01<00:14,  3.94it/s, accuracy=0.0536] 11%|█         | 7/63 [00:02<00:14,  3.94it/s, accuracy=0.0469] 13%|█▎        | 8/63 [00:02<00:17,  3.23it/s, accuracy=0.0469] 13%|█▎        | 8/63 [00:02<00:17,  3.23it/s, accuracy=0.066]  14%|█▍        | 9/63 [00:02<00:14,  3.85it/s, accuracy=0.066] 14%|█▍        | 9/63 [00:02<00:14,  3.85it/s, accuracy=0.0594] 16%|█▌        | 10/63 [00:02<00:16,  3.21it/s, accuracy=0.0594] 16%|█▌        | 10/63 [00:02<00:16,  3.21it/s, accuracy=0.0739] 17%|█▋        | 11/63 [00:02<00:13,  3.80it/s, accuracy=0.0739] 17%|█▋        | 11/63 [00:03<00:13,  3.80it/s, accuracy=0.0677] 19%|█▉        | 12/63 [00:03<00:16,  3.14it/s, accuracy=0.0677] 19%|█▉        | 12/63 [00:03<00:16,  3.14it/s, accuracy=0.0697] 21%|██        | 13/63 [00:03<00:13,  3.69it/s, accuracy=0.0697] 21%|██        | 13/63 [00:03<00:13,  3.69it/s, accuracy=0.0647] 22%|██▏       | 14/63 [00:03<00:16,  3.02it/s, accuracy=0.0647] 22%|██▏       | 14/63 [00:04<00:16,  3.02it/s, accuracy=0.0708] 24%|██▍       | 15/63 [00:04<00:13,  3.61it/s, accuracy=0.0708] 24%|██▍       | 15/63 [00:04<00:13,  3.61it/s, accuracy=0.0664] 25%|██▌       | 16/63 [00:04<00:15,  3.08it/s, accuracy=0.0664] 25%|██▌       | 16/63 [00:04<00:15,  3.08it/s, accuracy=0.0717] 27%|██▋       | 17/63 [00:04<00:12,  3.65it/s, accuracy=0.0717] 27%|██▋       | 17/63 [00:05<00:12,  3.65it/s, accuracy=0.0677] 29%|██▊       | 18/63 [00:05<00:14,  3.10it/s, accuracy=0.0677] 29%|██▊       | 18/63 [00:05<00:14,  3.10it/s, accuracy=0.0691] 30%|███       | 19/63 [00:05<00:12,  3.66it/s, accuracy=0.0691] 30%|███       | 19/63 [00:05<00:12,  3.66it/s, accuracy=0.0656] 32%|███▏      | 20/63 [00:05<00:13,  3.12it/s, accuracy=0.0656] 32%|███▏      | 20/63 [00:05<00:13,  3.12it/s, accuracy=0.0789] 33%|███▎      | 21/63 [00:05<00:11,  3.68it/s, accuracy=0.0789] 33%|███▎      | 21/63 [00:06<00:11,  3.68it/s, accuracy=0.0753] 35%|███▍      | 22/63 [00:06<00:13,  3.10it/s, accuracy=0.0753] 35%|███▍      | 22/63 [00:06<00:13,  3.10it/s, accuracy=0.072]  37%|███▋      | 23/63 [00:06<00:11,  3.59it/s, accuracy=0.072] 37%|███▋      | 23/63 [00:06<00:11,  3.59it/s, accuracy=0.069] 38%|███▊      | 24/63 [00:06<00:12,  3.07it/s, accuracy=0.069] 38%|███▊      | 24/63 [00:07<00:12,  3.07it/s, accuracy=0.0762] 40%|███▉      | 25/63 [00:07<00:10,  3.62it/s, accuracy=0.0762] 40%|███▉      | 25/63 [00:07<00:10,  3.62it/s, accuracy=0.0733] 41%|████▏     | 26/63 [00:07<00:12,  3.08it/s, accuracy=0.0733] 41%|████▏     | 26/63 [00:07<00:12,  3.08it/s, accuracy=0.0775] 43%|████▎     | 27/63 [00:07<00:09,  3.64it/s, accuracy=0.0775] 43%|████▎     | 27/63 [00:08<00:09,  3.64it/s, accuracy=0.0748] 44%|████▍     | 28/63 [00:08<00:11,  3.11it/s, accuracy=0.0748] 44%|████▍     | 28/63 [00:08<00:11,  3.11it/s, accuracy=0.0765] 46%|████▌     | 29/63 [00:08<00:09,  3.66it/s, accuracy=0.0765] 46%|████▌     | 29/63 [00:08<00:09,  3.66it/s, accuracy=0.074]  48%|████▊     | 30/63 [00:08<00:10,  3.09it/s, accuracy=0.074] 48%|████▊     | 30/63 [00:08<00:10,  3.09it/s, accuracy=0.0736] 49%|████▉     | 31/63 [00:08<00:08,  3.65it/s, accuracy=0.0736] 49%|████▉     | 31/63 [00:09<00:08,  3.65it/s, accuracy=0.0713] 51%|█████     | 32/63 [00:09<00:10,  3.10it/s, accuracy=0.0713] 51%|█████     | 32/63 [00:09<00:10,  3.10it/s, accuracy=0.0767] 52%|█████▏    | 33/63 [00:09<00:08,  3.67it/s, accuracy=0.0767] 52%|█████▏    | 33/63 [00:09<00:08,  3.67it/s, accuracy=0.0744] 54%|█████▍    | 34/63 [00:09<00:09,  3.09it/s, accuracy=0.0744] 54%|█████▍    | 34/63 [00:10<00:09,  3.09it/s, accuracy=0.0768] 56%|█████▌    | 35/63 [00:10<00:07,  3.65it/s, accuracy=0.0768] 56%|█████▌    | 35/63 [00:10<00:07,  3.65it/s, accuracy=0.0747] 57%|█████▋    | 36/63 [00:10<00:08,  3.11it/s, accuracy=0.0747] 57%|█████▋    | 36/63 [00:10<00:08,  3.11it/s, accuracy=0.0743] 59%|█████▊    | 37/63 [00:10<00:07,  3.68it/s, accuracy=0.0743] 59%|█████▊    | 37/63 [00:11<00:07,  3.68it/s, accuracy=0.0724] 60%|██████    | 38/63 [00:11<00:08,  3.12it/s, accuracy=0.0724] 60%|██████    | 38/63 [00:11<00:08,  3.12it/s, accuracy=0.0721] 62%|██████▏   | 39/63 [00:11<00:06,  3.65it/s, accuracy=0.0721] 62%|██████▏   | 39/63 [00:11<00:06,  3.65it/s, accuracy=0.0703] 63%|██████▎   | 40/63 [00:11<00:07,  3.10it/s, accuracy=0.0703] 63%|██████▎   | 40/63 [00:11<00:07,  3.10it/s, accuracy=0.0701] 65%|██████▌   | 41/63 [00:11<00:06,  3.66it/s, accuracy=0.0701] 65%|██████▌   | 41/63 [00:12<00:06,  3.66it/s, accuracy=0.0685] 67%|██████▋   | 42/63 [00:12<00:06,  3.11it/s, accuracy=0.0685] 67%|██████▋   | 42/63 [00:12<00:06,  3.11it/s, accuracy=0.0705] 68%|██████▊   | 43/63 [00:12<00:05,  3.68it/s, accuracy=0.0705] 68%|██████▊   | 43/63 [00:12<00:05,  3.68it/s, accuracy=0.0689] 70%|██████▉   | 44/63 [00:12<00:06,  3.12it/s, accuracy=0.0689] 70%|██████▉   | 44/63 [00:13<00:06,  3.12it/s, accuracy=0.0681] 71%|███████▏  | 45/63 [00:13<00:04,  3.61it/s, accuracy=0.0681] 71%|███████▏  | 45/63 [00:13<00:04,  3.61it/s, accuracy=0.0666] 73%|███████▎  | 46/63 [00:13<00:05,  3.08it/s, accuracy=0.0666] 73%|███████▎  | 46/63 [00:13<00:05,  3.08it/s, accuracy=0.0698] 75%|███████▍  | 47/63 [00:13<00:04,  3.62it/s, accuracy=0.0698] 75%|███████▍  | 47/63 [00:14<00:04,  3.62it/s, accuracy=0.0684] 76%|███████▌  | 48/63 [00:14<00:04,  3.09it/s, accuracy=0.0684] 76%|███████▌  | 48/63 [00:14<00:04,  3.09it/s, accuracy=0.0689] 78%|███████▊  | 49/63 [00:14<00:03,  3.66it/s, accuracy=0.0689] 78%|███████▊  | 49/63 [00:14<00:03,  3.66it/s, accuracy=0.0675] 79%|███████▉  | 50/63 [00:14<00:04,  3.06it/s, accuracy=0.0675] 79%|███████▉  | 50/63 [00:14<00:04,  3.06it/s, accuracy=0.0717] 81%|████████  | 51/63 [00:14<00:03,  3.63it/s, accuracy=0.0717] 81%|████████  | 51/63 [00:15<00:03,  3.63it/s, accuracy=0.0703] 83%|████████▎ | 52/63 [00:15<00:03,  2.89it/s, accuracy=0.0703] 83%|████████▎ | 52/63 [00:15<00:03,  2.89it/s, accuracy=0.0708] 84%|████████▍ | 53/63 [00:15<00:02,  3.46it/s, accuracy=0.0708] 84%|████████▍ | 53/63 [00:15<00:02,  3.46it/s, accuracy=0.0694] 86%|████████▌ | 54/63 [00:15<00:03,  2.99it/s, accuracy=0.0694] 86%|████████▌ | 54/63 [00:16<00:03,  2.99it/s, accuracy=0.0739] 87%|████████▋ | 55/63 [00:16<00:02,  3.56it/s, accuracy=0.0739] 87%|████████▋ | 55/63 [00:16<00:02,  3.56it/s, accuracy=0.0725] 89%|████████▉ | 56/63 [00:16<00:02,  3.07it/s, accuracy=0.0725] 89%|████████▉ | 56/63 [00:16<00:02,  3.07it/s, accuracy=0.0768] 90%|█████████ | 57/63 [00:16<00:01,  3.65it/s, accuracy=0.0768] 90%|█████████ | 57/63 [00:17<00:01,  3.65it/s, accuracy=0.0754] 92%|█████████▏| 58/63 [00:17<00:01,  3.12it/s, accuracy=0.0754] 92%|█████████▏| 58/63 [00:17<00:01,  3.12it/s, accuracy=0.0784] 94%|█████████▎| 59/63 [00:17<00:01,  3.70it/s, accuracy=0.0784] 94%|█████████▎| 59/63 [00:17<00:01,  3.70it/s, accuracy=0.0771] 95%|█████████▌| 60/63 [00:17<00:00,  3.01it/s, accuracy=0.0771] 95%|█████████▌| 60/63 [00:17<00:00,  3.01it/s, accuracy=0.0809] 97%|█████████▋| 61/63 [00:17<00:00,  3.57it/s, accuracy=0.0809] 97%|█████████▋| 61/63 [00:18<00:00,  3.57it/s, accuracy=0.0796] 98%|█████████▊| 62/63 [00:18<00:00,  3.07it/s, accuracy=0.0796] 98%|█████████▊| 62/63 [00:18<00:00,  3.07it/s, accuracy=0.0815]100%|██████████| 63/63 [00:18<00:00,  3.42it/s, accuracy=0.0815]
Final Accuracy : 0.0815
Average Loss: 0.4603987681865692
Confusion matrix and metrics saved for model: RoTTA+FOA(ResNet18)
../Attacks/CIFAR-10/ResNet18/PGD
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s, accuracy=0]  2%|▏         | 1/63 [00:00<00:51,  1.21it/s, accuracy=0]  2%|▏         | 1/63 [00:01<00:51,  1.21it/s, accuracy=0]  3%|▎         | 2/63 [00:01<00:44,  1.37it/s, accuracy=0]  3%|▎         | 2/63 [00:02<00:44,  1.37it/s, accuracy=0.0104]  5%|▍         | 3/63 [00:02<00:46,  1.29it/s, accuracy=0.0104]  5%|▍         | 3/63 [00:03<00:46,  1.29it/s, accuracy=0.00781]  6%|▋         | 4/63 [00:03<00:43,  1.34it/s, accuracy=0.00781]  6%|▋         | 4/63 [00:03<00:43,  1.34it/s, accuracy=0.0375]   8%|▊         | 5/63 [00:03<00:46,  1.26it/s, accuracy=0.0375]  8%|▊         | 5/63 [00:04<00:46,  1.26it/s, accuracy=0.0312] 10%|▉         | 6/63 [00:04<00:48,  1.18it/s, accuracy=0.0312] 10%|▉         | 6/63 [00:05<00:48,  1.18it/s, accuracy=0.0268] 11%|█         | 7/63 [00:05<00:47,  1.17it/s, accuracy=0.0268] 11%|█         | 7/63 [00:06<00:47,  1.17it/s, accuracy=0.0234] 13%|█▎        | 8/63 [00:06<00:49,  1.10it/s, accuracy=0.0234] 13%|█▎        | 8/63 [00:07<00:49,  1.10it/s, accuracy=0.0208] 14%|█▍        | 9/63 [00:07<00:49,  1.10it/s, accuracy=0.0208] 14%|█▍        | 9/63 [00:08<00:49,  1.10it/s, accuracy=0.0187] 16%|█▌        | 10/63 [00:08<00:48,  1.09it/s, accuracy=0.0187] 16%|█▌        | 10/63 [00:09<00:48,  1.09it/s, accuracy=0.017]  17%|█▋        | 11/63 [00:09<00:48,  1.08it/s, accuracy=0.017] 17%|█▋        | 11/63 [00:10<00:48,  1.08it/s, accuracy=0.0156] 19%|█▉        | 12/63 [00:10<00:47,  1.07it/s, accuracy=0.0156] 19%|█▉        | 12/63 [00:11<00:47,  1.07it/s, accuracy=0.0144] 21%|██        | 13/63 [00:11<00:45,  1.10it/s, accuracy=0.0144] 21%|██        | 13/63 [00:12<00:45,  1.10it/s, accuracy=0.0134] 22%|██▏       | 14/63 [00:12<00:44,  1.09it/s, accuracy=0.0134] 22%|██▏       | 14/63 [00:13<00:44,  1.09it/s, accuracy=0.0125] 24%|██▍       | 15/63 [00:13<00:43,  1.10it/s, accuracy=0.0125] 24%|██▍       | 15/63 [00:14<00:43,  1.10it/s, accuracy=0.0117] 25%|██▌       | 16/63 [00:14<00:44,  1.07it/s, accuracy=0.0117] 25%|██▌       | 16/63 [00:15<00:44,  1.07it/s, accuracy=0.011]  27%|██▋       | 17/63 [00:15<00:43,  1.06it/s, accuracy=0.011] 27%|██▋       | 17/63 [00:16<00:43,  1.06it/s, accuracy=0.0104] 29%|██▊       | 18/63 [00:16<00:43,  1.04it/s, accuracy=0.0104] 29%|██▊       | 18/63 [00:17<00:43,  1.04it/s, accuracy=0.00987] 30%|███       | 19/63 [00:17<00:41,  1.06it/s, accuracy=0.00987] 30%|███       | 19/63 [00:17<00:41,  1.06it/s, accuracy=0.00937] 32%|███▏      | 20/63 [00:17<00:40,  1.06it/s, accuracy=0.00937] 32%|███▏      | 20/63 [00:18<00:40,  1.06it/s, accuracy=0.00893] 33%|███▎      | 21/63 [00:18<00:38,  1.09it/s, accuracy=0.00893] 33%|███▎      | 21/63 [00:19<00:38,  1.09it/s, accuracy=0.00852] 35%|███▍      | 22/63 [00:19<00:37,  1.09it/s, accuracy=0.00852] 35%|███▍      | 22/63 [00:20<00:37,  1.09it/s, accuracy=0.00815] 37%|███▋      | 23/63 [00:20<00:35,  1.11it/s, accuracy=0.00815] 37%|███▋      | 23/63 [00:21<00:35,  1.11it/s, accuracy=0.00781] 38%|███▊      | 24/63 [00:21<00:35,  1.10it/s, accuracy=0.00781] 38%|███▊      | 24/63 [00:22<00:35,  1.10it/s, accuracy=0.0075]  40%|███▉      | 25/63 [00:22<00:33,  1.12it/s, accuracy=0.0075] 40%|███▉      | 25/63 [00:23<00:33,  1.12it/s, accuracy=0.00721] 41%|████▏     | 26/63 [00:23<00:33,  1.11it/s, accuracy=0.00721] 41%|████▏     | 26/63 [00:24<00:33,  1.11it/s, accuracy=0.00694] 43%|████▎     | 27/63 [00:24<00:32,  1.12it/s, accuracy=0.00694] 43%|████▎     | 27/63 [00:25<00:32,  1.12it/s, accuracy=0.0067]  44%|████▍     | 28/63 [00:25<00:31,  1.09it/s, accuracy=0.0067] 44%|████▍     | 28/63 [00:26<00:31,  1.09it/s, accuracy=0.0097] 46%|████▌     | 29/63 [00:26<00:30,  1.11it/s, accuracy=0.0097] 46%|████▌     | 29/63 [00:26<00:30,  1.11it/s, accuracy=0.00937] 48%|████▊     | 30/63 [00:26<00:30,  1.10it/s, accuracy=0.00937] 48%|████▊     | 30/63 [00:27<00:30,  1.10it/s, accuracy=0.00907] 49%|████▉     | 31/63 [00:27<00:28,  1.11it/s, accuracy=0.00907] 49%|████▉     | 31/63 [00:28<00:28,  1.11it/s, accuracy=0.00879] 51%|█████     | 32/63 [00:28<00:28,  1.09it/s, accuracy=0.00879] 51%|█████     | 32/63 [00:29<00:28,  1.09it/s, accuracy=0.00852] 52%|█████▏    | 33/63 [00:29<00:28,  1.07it/s, accuracy=0.00852] 52%|█████▏    | 33/63 [00:30<00:28,  1.07it/s, accuracy=0.00827] 54%|█████▍    | 34/63 [00:30<00:27,  1.05it/s, accuracy=0.00827] 54%|█████▍    | 34/63 [00:31<00:27,  1.05it/s, accuracy=0.00804] 56%|█████▌    | 35/63 [00:31<00:26,  1.08it/s, accuracy=0.00804] 56%|█████▌    | 35/63 [00:32<00:26,  1.08it/s, accuracy=0.00781] 57%|█████▋    | 36/63 [00:32<00:25,  1.07it/s, accuracy=0.00781] 57%|█████▋    | 36/63 [00:33<00:25,  1.07it/s, accuracy=0.0076]  59%|█████▊    | 37/63 [00:33<00:24,  1.07it/s, accuracy=0.0076] 59%|█████▊    | 37/63 [00:34<00:24,  1.07it/s, accuracy=0.0074] 60%|██████    | 38/63 [00:34<00:23,  1.07it/s, accuracy=0.0074] 60%|██████    | 38/63 [00:35<00:23,  1.07it/s, accuracy=0.00721] 62%|██████▏   | 39/63 [00:35<00:22,  1.08it/s, accuracy=0.00721] 62%|██████▏   | 39/63 [00:36<00:22,  1.08it/s, accuracy=0.00703] 63%|██████▎   | 40/63 [00:36<00:21,  1.08it/s, accuracy=0.00703] 63%|██████▎   | 40/63 [00:37<00:21,  1.08it/s, accuracy=0.00686] 65%|██████▌   | 41/63 [00:37<00:20,  1.10it/s, accuracy=0.00686] 65%|██████▌   | 41/63 [00:38<00:20,  1.10it/s, accuracy=0.0067]  67%|██████▋   | 42/63 [00:38<00:19,  1.09it/s, accuracy=0.0067] 67%|██████▋   | 42/63 [00:38<00:19,  1.09it/s, accuracy=0.00654] 68%|██████▊   | 43/63 [00:38<00:18,  1.11it/s, accuracy=0.00654] 68%|██████▊   | 43/63 [00:39<00:18,  1.11it/s, accuracy=0.00639] 70%|██████▉   | 44/63 [00:39<00:17,  1.06it/s, accuracy=0.00639] 70%|██████▉   | 44/63 [00:40<00:17,  1.06it/s, accuracy=0.00625] 71%|███████▏  | 45/63 [00:40<00:17,  1.05it/s, accuracy=0.00625] 71%|███████▏  | 45/63 [00:41<00:17,  1.05it/s, accuracy=0.00611] 73%|███████▎  | 46/63 [00:41<00:16,  1.03it/s, accuracy=0.00611] 73%|███████▎  | 46/63 [00:42<00:16,  1.03it/s, accuracy=0.00731] 75%|███████▍  | 47/63 [00:42<00:15,  1.03it/s, accuracy=0.00731] 75%|███████▍  | 47/63 [00:43<00:15,  1.03it/s, accuracy=0.00716] 76%|███████▌  | 48/63 [00:43<00:14,  1.03it/s, accuracy=0.00716] 76%|███████▌  | 48/63 [00:44<00:14,  1.03it/s, accuracy=0.00702] 78%|███████▊  | 49/63 [00:44<00:13,  1.06it/s, accuracy=0.00702] 78%|███████▊  | 49/63 [00:45<00:13,  1.06it/s, accuracy=0.00688] 79%|███████▉  | 50/63 [00:45<00:12,  1.06it/s, accuracy=0.00688] 79%|███████▉  | 50/63 [00:46<00:12,  1.06it/s, accuracy=0.00674] 81%|████████  | 51/63 [00:46<00:11,  1.09it/s, accuracy=0.00674] 81%|████████  | 51/63 [00:47<00:11,  1.09it/s, accuracy=0.00661] 83%|████████▎ | 52/63 [00:47<00:10,  1.07it/s, accuracy=0.00661] 83%|████████▎ | 52/63 [00:48<00:10,  1.07it/s, accuracy=0.00649] 84%|████████▍ | 53/63 [00:48<00:09,  1.06it/s, accuracy=0.00649] 84%|████████▍ | 53/63 [00:49<00:09,  1.06it/s, accuracy=0.00637] 86%|████████▌ | 54/63 [00:49<00:08,  1.05it/s, accuracy=0.00637] 86%|████████▌ | 54/63 [00:50<00:08,  1.05it/s, accuracy=0.00625] 87%|████████▋ | 55/63 [00:50<00:07,  1.07it/s, accuracy=0.00625] 87%|████████▋ | 55/63 [00:51<00:07,  1.07it/s, accuracy=0.00614] 89%|████████▉ | 56/63 [00:51<00:06,  1.07it/s, accuracy=0.00614] 89%|████████▉ | 56/63 [00:52<00:06,  1.07it/s, accuracy=0.00658] 90%|█████████ | 57/63 [00:52<00:05,  1.06it/s, accuracy=0.00658] 90%|█████████ | 57/63 [00:53<00:05,  1.06it/s, accuracy=0.00647] 92%|█████████▏| 58/63 [00:53<00:04,  1.05it/s, accuracy=0.00647] 92%|█████████▏| 58/63 [00:54<00:04,  1.05it/s, accuracy=0.00636] 94%|█████████▎| 59/63 [00:54<00:03,  1.07it/s, accuracy=0.00636] 94%|█████████▎| 59/63 [00:55<00:03,  1.07it/s, accuracy=0.00625] 95%|█████████▌| 60/63 [00:55<00:02,  1.07it/s, accuracy=0.00625] 95%|█████████▌| 60/63 [00:55<00:02,  1.07it/s, accuracy=0.00717] 97%|█████████▋| 61/63 [00:55<00:01,  1.09it/s, accuracy=0.00717] 97%|█████████▋| 61/63 [00:57<00:01,  1.09it/s, accuracy=0.00706] 98%|█████████▊| 62/63 [00:57<00:00,  1.05it/s, accuracy=0.00706] 98%|█████████▊| 62/63 [00:57<00:00,  1.05it/s, accuracy=0.007]  100%|██████████| 63/63 [00:57<00:00,  1.22it/s, accuracy=0.007]100%|██████████| 63/63 [00:57<00:00,  1.10it/s, accuracy=0.007]
Final Accuracy : 0.007
Average Loss: 0.5106907458305359
Confusion matrix and metrics saved for model: RoTTA+FOA(ResNet18)
../Attacks/CIFAR-10/ResNet18/CW
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:16<?, ?it/s, accuracy=0.844]  2%|▏         | 1/63 [00:16<17:27, 16.90s/it, accuracy=0.844]  2%|▏         | 1/63 [00:29<17:27, 16.90s/it, accuracy=0.922]  3%|▎         | 2/63 [00:29<14:19, 14.09s/it, accuracy=0.922]  3%|▎         | 2/63 [00:46<14:19, 14.09s/it, accuracy=0.917]  5%|▍         | 3/63 [00:46<15:30, 15.51s/it, accuracy=0.917]  5%|▍         | 3/63 [00:58<15:30, 15.51s/it, accuracy=0.914]  6%|▋         | 4/63 [00:58<13:59, 14.23s/it, accuracy=0.914]  6%|▋         | 4/63 [01:15<13:59, 14.23s/it, accuracy=0.906]  8%|▊         | 5/63 [01:15<14:50, 15.35s/it, accuracy=0.906]  8%|▊         | 5/63 [01:28<14:50, 15.35s/it, accuracy=0.906] 10%|▉         | 6/63 [01:28<13:39, 14.38s/it, accuracy=0.906] 10%|▉         | 6/63 [01:45<13:39, 14.38s/it, accuracy=0.902] 11%|█         | 7/63 [01:45<14:23, 15.42s/it, accuracy=0.902] 11%|█         | 7/63 [02:04<14:23, 15.42s/it, accuracy=0.91]  13%|█▎        | 8/63 [02:04<15:07, 16.49s/it, accuracy=0.91] 13%|█▎        | 8/63 [02:31<15:07, 16.49s/it, accuracy=0.913] 14%|█▍        | 9/63 [02:31<17:41, 19.66s/it, accuracy=0.913] 14%|█▍        | 9/63 [02:44<17:41, 19.66s/it, accuracy=0.916] 16%|█▌        | 10/63 [02:44<15:30, 17.55s/it, accuracy=0.916] 16%|█▌        | 10/63 [03:01<15:30, 17.55s/it, accuracy=0.92]  17%|█▋        | 11/63 [03:01<15:16, 17.62s/it, accuracy=0.92] 17%|█▋        | 11/63 [03:14<15:16, 17.62s/it, accuracy=0.924] 19%|█▉        | 12/63 [03:14<13:42, 16.12s/it, accuracy=0.924] 19%|█▉        | 12/63 [03:32<13:42, 16.12s/it, accuracy=0.916] 21%|██        | 13/63 [03:32<13:49, 16.59s/it, accuracy=0.916] 21%|██        | 13/63 [03:51<13:49, 16.59s/it, accuracy=0.915] 22%|██▏       | 14/63 [03:51<14:06, 17.29s/it, accuracy=0.915] 22%|██▏       | 14/63 [04:08<14:06, 17.29s/it, accuracy=0.917] 24%|██▍       | 15/63 [04:08<13:54, 17.39s/it, accuracy=0.917] 24%|██▍       | 15/63 [04:21<13:54, 17.39s/it, accuracy=0.91]  25%|██▌       | 16/63 [04:21<12:29, 15.95s/it, accuracy=0.91] 25%|██▌       | 16/63 [04:39<12:29, 15.95s/it, accuracy=0.914] 27%|██▋       | 17/63 [04:39<12:45, 16.65s/it, accuracy=0.914] 27%|██▋       | 17/63 [04:52<12:45, 16.65s/it, accuracy=0.911] 29%|██▊       | 18/63 [04:52<11:35, 15.46s/it, accuracy=0.911] 29%|██▊       | 18/63 [05:09<11:35, 15.46s/it, accuracy=0.903] 30%|███       | 19/63 [05:09<11:44, 16.02s/it, accuracy=0.903] 30%|███       | 19/63 [05:22<11:44, 16.02s/it, accuracy=0.889] 32%|███▏      | 20/63 [05:22<10:43, 14.97s/it, accuracy=0.889] 32%|███▏      | 20/63 [05:39<10:43, 14.97s/it, accuracy=0.881] 33%|███▎      | 21/63 [05:39<10:57, 15.66s/it, accuracy=0.881] 33%|███▎      | 21/63 [05:51<10:57, 15.66s/it, accuracy=0.874] 35%|███▍      | 22/63 [05:51<10:03, 14.71s/it, accuracy=0.874] 35%|███▍      | 22/63 [06:09<10:03, 14.71s/it, accuracy=0.864] 37%|███▋      | 23/63 [06:09<10:18, 15.47s/it, accuracy=0.864] 37%|███▋      | 23/63 [06:21<10:18, 15.47s/it, accuracy=0.858] 38%|███▊      | 24/63 [06:21<09:28, 14.58s/it, accuracy=0.858] 38%|███▊      | 24/63 [06:38<09:28, 14.58s/it, accuracy=0.851] 40%|███▉      | 25/63 [06:38<09:44, 15.38s/it, accuracy=0.851] 40%|███▉      | 25/63 [06:51<09:44, 15.38s/it, accuracy=0.847] 41%|████▏     | 26/63 [06:51<08:58, 14.55s/it, accuracy=0.847] 41%|████▏     | 26/63 [07:09<08:58, 14.55s/it, accuracy=0.85]  43%|████▎     | 27/63 [07:09<09:17, 15.48s/it, accuracy=0.85] 43%|████▎     | 27/63 [07:22<09:17, 15.48s/it, accuracy=0.853] 44%|████▍     | 28/63 [07:22<08:33, 14.68s/it, accuracy=0.853] 44%|████▍     | 28/63 [07:48<08:33, 14.68s/it, accuracy=0.851] 46%|████▌     | 29/63 [07:48<10:23, 18.34s/it, accuracy=0.851] 46%|████▌     | 29/63 [08:01<10:23, 18.34s/it, accuracy=0.852] 48%|████▊     | 30/63 [08:01<09:11, 16.71s/it, accuracy=0.852] 48%|████▊     | 30/63 [08:19<09:11, 16.71s/it, accuracy=0.856] 49%|████▉     | 31/63 [08:19<09:06, 17.08s/it, accuracy=0.856] 49%|████▉     | 31/63 [08:39<09:06, 17.08s/it, accuracy=0.854] 51%|█████     | 32/63 [08:39<09:11, 17.79s/it, accuracy=0.854] 51%|█████     | 32/63 [08:57<09:11, 17.79s/it, accuracy=0.856] 52%|█████▏    | 33/63 [08:57<09:00, 18.02s/it, accuracy=0.856] 52%|█████▏    | 33/63 [09:10<09:00, 18.02s/it, accuracy=0.856] 54%|█████▍    | 34/63 [09:10<07:58, 16.51s/it, accuracy=0.856] 54%|█████▍    | 34/63 [09:28<07:58, 16.51s/it, accuracy=0.854] 56%|█████▌    | 35/63 [09:28<07:51, 16.83s/it, accuracy=0.854] 56%|█████▌    | 35/63 [09:53<07:51, 16.83s/it, accuracy=0.853] 57%|█████▋    | 36/63 [09:53<08:41, 19.32s/it, accuracy=0.853] 57%|█████▋    | 36/63 [10:19<08:41, 19.32s/it, accuracy=0.854] 59%|█████▊    | 37/63 [10:19<09:15, 21.38s/it, accuracy=0.854] 59%|█████▊    | 37/63 [10:32<09:15, 21.38s/it, accuracy=0.854] 60%|██████    | 38/63 [10:32<07:50, 18.83s/it, accuracy=0.854] 60%|██████    | 38/63 [10:50<07:50, 18.83s/it, accuracy=0.857] 62%|██████▏   | 39/63 [10:50<07:27, 18.66s/it, accuracy=0.857] 62%|██████▏   | 39/63 [11:03<07:27, 18.66s/it, accuracy=0.859] 63%|██████▎   | 40/63 [11:03<06:30, 17.00s/it, accuracy=0.859] 63%|██████▎   | 40/63 [11:21<06:30, 17.00s/it, accuracy=0.861] 65%|██████▌   | 41/63 [11:21<06:18, 17.19s/it, accuracy=0.861] 65%|██████▌   | 41/63 [11:34<06:18, 17.19s/it, accuracy=0.863] 67%|██████▋   | 42/63 [11:34<05:36, 16.00s/it, accuracy=0.863] 67%|██████▋   | 42/63 [11:53<05:36, 16.00s/it, accuracy=0.866] 68%|██████▊   | 43/63 [11:53<05:35, 16.76s/it, accuracy=0.866] 68%|██████▊   | 43/63 [12:12<05:35, 16.76s/it, accuracy=0.866] 70%|██████▉   | 44/63 [12:12<05:32, 17.49s/it, accuracy=0.866] 70%|██████▉   | 44/63 [12:30<05:32, 17.49s/it, accuracy=0.869] 71%|███████▏  | 45/63 [12:30<05:15, 17.51s/it, accuracy=0.869] 71%|███████▏  | 45/63 [12:42<05:15, 17.51s/it, accuracy=0.87]  73%|███████▎  | 46/63 [12:42<04:33, 16.07s/it, accuracy=0.87] 73%|███████▎  | 46/63 [13:00<04:33, 16.07s/it, accuracy=0.871] 75%|███████▍  | 47/63 [13:00<04:24, 16.54s/it, accuracy=0.871] 75%|███████▍  | 47/63 [13:13<04:24, 16.54s/it, accuracy=0.872] 76%|███████▌  | 48/63 [13:13<03:53, 15.54s/it, accuracy=0.872] 76%|███████▌  | 48/63 [13:31<03:53, 15.54s/it, accuracy=0.874] 78%|███████▊  | 49/63 [13:31<03:48, 16.35s/it, accuracy=0.874] 78%|███████▊  | 49/63 [13:45<03:48, 16.35s/it, accuracy=0.876] 79%|███████▉  | 50/63 [13:45<03:20, 15.45s/it, accuracy=0.876] 79%|███████▉  | 50/63 [14:12<03:20, 15.45s/it, accuracy=0.877] 81%|████████  | 51/63 [14:12<03:47, 18.93s/it, accuracy=0.877] 81%|████████  | 51/63 [14:31<03:47, 18.93s/it, accuracy=0.879] 83%|████████▎ | 52/63 [14:31<03:28, 18.93s/it, accuracy=0.879] 83%|████████▎ | 52/63 [14:49<03:28, 18.93s/it, accuracy=0.88]  84%|████████▍ | 53/63 [14:49<03:06, 18.61s/it, accuracy=0.88] 84%|████████▍ | 53/63 [15:01<03:06, 18.61s/it, accuracy=0.88] 86%|████████▌ | 54/63 [15:01<02:32, 16.89s/it, accuracy=0.88] 86%|████████▌ | 54/63 [15:19<02:32, 16.89s/it, accuracy=0.882] 87%|████████▋ | 55/63 [15:19<02:17, 17.13s/it, accuracy=0.882] 87%|████████▋ | 55/63 [15:32<02:17, 17.13s/it, accuracy=0.883] 89%|████████▉ | 56/63 [15:32<01:51, 15.95s/it, accuracy=0.883] 89%|████████▉ | 56/63 [15:50<01:51, 15.95s/it, accuracy=0.884] 90%|█████████ | 57/63 [15:50<01:38, 16.46s/it, accuracy=0.884] 90%|█████████ | 57/63 [16:03<01:38, 16.46s/it, accuracy=0.885] 92%|█████████▏| 58/63 [16:03<01:17, 15.41s/it, accuracy=0.885] 92%|█████████▏| 58/63 [16:21<01:17, 15.41s/it, accuracy=0.885] 94%|█████████▎| 59/63 [16:21<01:04, 16.11s/it, accuracy=0.885] 94%|█████████▎| 59/63 [16:34<01:04, 16.11s/it, accuracy=0.887] 95%|█████████▌| 60/63 [16:34<00:45, 15.16s/it, accuracy=0.887] 95%|█████████▌| 60/63 [16:52<00:45, 15.16s/it, accuracy=0.889] 97%|█████████▋| 61/63 [16:52<00:31, 15.99s/it, accuracy=0.889] 97%|█████████▋| 61/63 [17:04<00:31, 15.99s/it, accuracy=0.89]  98%|█████████▊| 62/63 [17:04<00:15, 15.03s/it, accuracy=0.89] 98%|█████████▊| 62/63 [17:14<00:15, 15.03s/it, accuracy=0.89]100%|██████████| 63/63 [17:14<00:00, 13.39s/it, accuracy=0.89]100%|██████████| 63/63 [17:14<00:00, 16.42s/it, accuracy=0.89]
Final Accuracy : 0.89
Average Loss: 0.01413998516567517
Confusion matrix and metrics saved for model: RoTTA+FOA(ResNet18)
../Attacks/CIFAR-10/ResNet18/AutoAttack
===> begin calculating mean and variance for ResNet18
===> calculating mean and variance for ResNet18 end
  0%|          | 0/63 [00:00<?, ?it/s]  0%|          | 0/63 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/project/Documents/RoTTA Enhancement/RoTTA/main.py", line 64, in <module>
    main()
  File "/home/project/Documents/RoTTA Enhancement/RoTTA/main.py", line 61, in main
    testTimeAdaptation(student, dataset_dir, model_name, attack)
  File "/home/project/Documents/RoTTA Enhancement/RoTTA/main.py", line 46, in testTimeAdaptation
    evaluate_tta(loader, tta_model, student, f'RoTTA+FOA({model_name})', attack_type)
  File "/home/project/Documents/RoTTA Enhancement/RoTTA/helper.py", line 99, in evaluate_tta
    images = adversary.perturb(images, labels)
             ^^^^^^^^^^^^^^^^^
AttributeError: 'AutoAttack' object has no attribute 'perturb'
